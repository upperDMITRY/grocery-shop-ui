{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useEffect,useRef}from'react';import{useSelector,useDispatch}from'react-redux';import{useHistory}from'react-router-dom';import axios from'axios';import{Box,Button}from'@mui/material';import{initProduct}from'../../../../redux/slices/adminProducts';import Id from'./Id';import Name from'./Name';import Description from'./Description';import Price from'./Price';import Rating from'./Rating';import SizeType from'./SizeType';import Sizes from'./Sizes';import Image from'./Image';import ImageLink from'./ImageLink';import{setDisabledSaveButton,setAdminProductsError}from'../../../../redux/slices/adminProducts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var productFormContainerStyle={boxSizing:'border-box',display:'flex',flexDirection:'column',flexWrap:'wrap',gap:4,paddingLeft:4,paddingRight:4,paddingTop:2,maxWidth:616,minWidth:288};var container1Style={display:'flex',flexWrap:'wrap',gap:4};var container2Style={display:'flex',flexWrap:'wrap',gap:4,flexGrow:1,'@media (min-width: 893px)':{width:'288px',flexGrow:0}};var container3Style={display:'flex',gap:3,flexGrow:1};var buttonsContainerStyle={display:'flex',paddingBottom:'32px',paddingTop:'8px',marginLeft:'-10px'};var buttonStyle={margin:'0 10px'};var prevProduct;var ProductForm=function ProductForm(){var dispatch=useDispatch();var history=useHistory();var token=useSelector(function(state){return state.auth.token;});var id=useSelector(function(state){return state.adminProducts.id;});var name=useSelector(function(state){return state.adminProducts.name;});var description=useSelector(function(state){return state.adminProducts.description;});var price=useSelector(function(state){return state.adminProducts.price;});var rating=useSelector(function(state){return state.adminProducts.rating;});var sizeType=useSelector(function(state){return state.adminProducts.sizeType;});var sizes=useSelector(function(state){return state.adminProducts.sizes;});var image=useSelector(function(state){return state.adminProducts.image;});var imageError=useSelector(function(state){return state.adminProducts.imageError;});var disabledSaveButton=useSelector(function(state){return state.adminProducts.disabledSaveButton;});var nameRef=useRef();useEffect(function(){if(nameRef){var _nameRef$current;(_nameRef$current=nameRef.current)===null||_nameRef$current===void 0?void 0:_nameRef$current.children[0].focus();}prevProduct={id:id,name:name,description:description,price:price,rating:rating,sizeType:sizeType,sizes:sizes,image:image};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(function(){if(name.trim()&&!imageError){dispatch(setDisabledSaveButton(false));}else{dispatch(setDisabledSaveButton(true));}},[dispatch,name,imageError]);var goBack=function goBack(){history.goBack();dispatch(initProduct());};var saveProduct=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var product,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:product={id:id,name:name,description:description,price:price||0,rating:rating||0,sizeType:sizeType,sizes:sizes,image:image};if(!(JSON.stringify(prevProduct)!==JSON.stringify(product))){_context.next=14;break;}_context.prev=2;_context.next=5;return axios({method:'post',url:'/api/products',headers:{Authorization:token},data:product});case 5:response=_context.sent;if(response.status>=200&&response.status<300){goBack();}_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);if(axios.isAxiosError(_context.t0)){if(_context.t0&&_context.t0.response){dispatch(setAdminProductsError(_context.t0.response.data.message));}}case 12:_context.next=15;break;case 14:goBack();case 15:case\"end\":return _context.stop();}}},_callee,null,[[2,9]]);}));return function saveProduct(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Box,{sx:productFormContainerStyle,children:[/*#__PURE__*/_jsx(Id,{}),/*#__PURE__*/_jsx(Name,{ref:nameRef}),/*#__PURE__*/_jsx(Description,{}),/*#__PURE__*/_jsxs(Box,{sx:container1Style,children:[/*#__PURE__*/_jsxs(Box,{sx:container2Style,children:[/*#__PURE__*/_jsxs(Box,{sx:container3Style,children:[/*#__PURE__*/_jsx(Price,{}),/*#__PURE__*/_jsx(Rating,{})]}),/*#__PURE__*/_jsx(SizeType,{}),/*#__PURE__*/_jsx(Sizes,{})]}),/*#__PURE__*/_jsx(Image,{})]}),/*#__PURE__*/_jsx(ImageLink,{}),/*#__PURE__*/_jsxs(Box,{sx:buttonsContainerStyle,children:[/*#__PURE__*/_jsx(Button,{sx:buttonStyle,variant:\"outlined\",onClick:goBack,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{sx:buttonStyle,variant:\"outlined\",onClick:saveProduct,disabled:disabledSaveButton,children:\"Save\"})]})]});};export default ProductForm;","map":{"version":3,"sources":["/Users/dcurchin/Desktop/final/grocery-shop-ui/src/components/adminPanel/products/editAndAddNewProduct/ProductForm.jsx"],"names":["useEffect","useRef","useSelector","useDispatch","useHistory","axios","Box","Button","initProduct","Id","Name","Description","Price","Rating","SizeType","Sizes","Image","ImageLink","setDisabledSaveButton","setAdminProductsError","productFormContainerStyle","boxSizing","display","flexDirection","flexWrap","gap","paddingLeft","paddingRight","paddingTop","maxWidth","minWidth","container1Style","container2Style","flexGrow","width","container3Style","buttonsContainerStyle","paddingBottom","marginLeft","buttonStyle","margin","prevProduct","ProductForm","dispatch","history","token","state","auth","id","adminProducts","name","description","price","rating","sizeType","sizes","image","imageError","disabledSaveButton","nameRef","current","children","focus","trim","goBack","saveProduct","product","JSON","stringify","method","url","headers","Authorization","data","response","status","isAxiosError","message"],"mappings":"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","sourcesContent":["import { useEffect, useRef } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { Box, Button } from '@mui/material';\r\nimport { initProduct } from '../../../../redux/slices/adminProducts';\r\nimport Id from './Id';\r\nimport Name from './Name';\r\nimport Description from './Description';\r\nimport Price from './Price';\r\nimport Rating from './Rating';\r\nimport SizeType from './SizeType';\r\nimport Sizes from './Sizes';\r\nimport Image from './Image';\r\nimport ImageLink from './ImageLink';\r\nimport {\r\n  setDisabledSaveButton,\r\n  setAdminProductsError,\r\n} from '../../../../redux/slices/adminProducts';\r\n\r\nconst productFormContainerStyle = {\r\n  boxSizing: 'border-box',\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  flexWrap: 'wrap',\r\n  gap: 4,\r\n  paddingLeft: 4,\r\n  paddingRight: 4,\r\n  paddingTop: 2,\r\n  maxWidth: 616,\r\n  minWidth: 288,\r\n};\r\n\r\nconst container1Style = {\r\n  display: 'flex',\r\n  flexWrap: 'wrap',\r\n  gap: 4,\r\n};\r\n\r\nconst container2Style = {\r\n  display: 'flex',\r\n  flexWrap: 'wrap',\r\n  gap: 4,\r\n  flexGrow: 1,\r\n  '@media (min-width: 893px)': {\r\n    width: '288px',\r\n    flexGrow: 0,\r\n  },\r\n};\r\n\r\nconst container3Style = { display: 'flex', gap: 3, flexGrow: 1 };\r\n\r\nconst buttonsContainerStyle = {\r\n  display: 'flex',\r\n  paddingBottom: '32px',\r\n  paddingTop: '8px',\r\n  marginLeft: '-10px',\r\n};\r\n\r\nconst buttonStyle = {\r\n  margin: '0 10px',\r\n};\r\n\r\nlet prevProduct;\r\n\r\nconst ProductForm = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const history = useHistory();\r\n\r\n  const token = useSelector((state) => state.auth.token);\r\n  const id = useSelector((state) => state.adminProducts.id);\r\n  const name = useSelector((state) => state.adminProducts.name);\r\n  const description = useSelector((state) => state.adminProducts.description);\r\n  const price = useSelector((state) => state.adminProducts.price);\r\n  const rating = useSelector((state) => state.adminProducts.rating);\r\n  const sizeType = useSelector((state) => state.adminProducts.sizeType);\r\n  const sizes = useSelector((state) => state.adminProducts.sizes);\r\n  const image = useSelector((state) => state.adminProducts.image);\r\n  const imageError = useSelector((state) => state.adminProducts.imageError);\r\n  const disabledSaveButton = useSelector(\r\n    (state) => state.adminProducts.disabledSaveButton\r\n  );\r\n\r\n  const nameRef = useRef();\r\n\r\n  useEffect(() => {\r\n    if (nameRef) {\r\n      nameRef.current?.children[0].focus();\r\n    }\r\n    prevProduct = {\r\n      id,\r\n      name,\r\n      description,\r\n      price,\r\n      rating,\r\n      sizeType,\r\n      sizes,\r\n      image,\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (name.trim() && !imageError) {\r\n      dispatch(setDisabledSaveButton(false));\r\n    } else {\r\n      dispatch(setDisabledSaveButton(true));\r\n    }\r\n  }, [dispatch, name, imageError]);\r\n\r\n  const goBack = () => {\r\n    history.goBack();\r\n    dispatch(initProduct());\r\n  };\r\n\r\n  const saveProduct = async () => {\r\n    const product = {\r\n      id,\r\n      name,\r\n      description,\r\n      price: price || 0,\r\n      rating: rating || 0,\r\n      sizeType,\r\n      sizes,\r\n      image,\r\n    };\r\n\r\n    if (JSON.stringify(prevProduct) !== JSON.stringify(product)) {\r\n      try {\r\n        const response = await axios({\r\n          method: 'post',\r\n          url: '/api/products',\r\n          headers: {\r\n            Authorization: token,\r\n          },\r\n          data: product,\r\n        });\r\n        if (response.status >= 200 && response.status < 300) {\r\n          goBack();\r\n        }\r\n      } catch (err) {\r\n        if (axios.isAxiosError(err)) {\r\n          if (err && err.response) {\r\n            dispatch(setAdminProductsError(err.response.data.message));\r\n          }\r\n        }\r\n      }\r\n    } else goBack();\r\n  };\r\n\r\n  return (\r\n    <Box sx={productFormContainerStyle}>\r\n      <Id />\r\n      <Name ref={nameRef} />\r\n      <Description />\r\n      <Box sx={container1Style}>\r\n        <Box sx={container2Style}>\r\n          <Box sx={container3Style}>\r\n            <Price />\r\n            <Rating />\r\n          </Box>\r\n          <SizeType />\r\n          <Sizes />\r\n        </Box>\r\n        <Image />\r\n      </Box>\r\n      <ImageLink />\r\n      <Box sx={buttonsContainerStyle}>\r\n        <Button sx={buttonStyle} variant=\"outlined\" onClick={goBack}>\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          sx={buttonStyle}\r\n          variant=\"outlined\"\r\n          onClick={saveProduct}\r\n          disabled={disabledSaveButton}\r\n        >\r\n          Save\r\n        </Button>\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default ProductForm;\r\n"]},"metadata":{},"sourceType":"module"}