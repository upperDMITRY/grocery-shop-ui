{"ast":null,"code":"var _jsxFileName = \"/Users/dcurchin/Desktop/final/grocery-shop-ui/src/components/checkout/Main.jsx\",\n    _s = $RefreshSig$();\n\nimport { Typography, Box, Divider } from '@mui/material';\nimport { React, useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport ContactInformation from './ContactInformation';\nimport SaveInformation from './SaveInformation';\nimport ShippingAddress from './ShippingAddress';\nimport CommonButton from '../common/buttons/CommonButton';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { emailValidation } from '../../helpers/emailValidation';\nimport axios from 'axios';\nimport { anyString255Validation } from '../../helpers/anyString255Validation';\nimport { setIsChecked, setDataInDb } from '../../redux/slices/checkoutSlice';\nimport { rewriteCart } from '../../redux/slices/cartSlice';\nimport AccordionComponent from './AccordionComponent';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst mainStyle = {\n  paddingRight: '4em',\n  paddingTop: '4em',\n  paddingLeft: '14%',\n  color: '#333333',\n  width: '55%',\n  display: 'flex',\n  flexDirection: 'column',\n  gap: '12px',\n  backgroundColor: '#fff',\n  '@media (max-width : 1000px)': {\n    width: '100%',\n    paddingTop: '1.5em',\n    paddingLeft: '15%',\n    paddingRight: '15%'\n  },\n  '@media (max-width: 750px)': {\n    display: 'block'\n  }\n};\nconst bottomButtons = {\n  display: 'flex',\n  alignItems: 'baseline',\n  gap: '18px',\n  marginBottom: '4em',\n  '& a': {\n    textDecoration: 'none',\n    color: 'primary.main',\n    '@media (max-width: 750px)': {\n      paddingTop: '15px',\n      width: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      '&::before': {\n        content: '\"❮\"',\n        paddingRight: '5px'\n      }\n    }\n  },\n  '@media (max-width: 750px)': {\n    display: 'block',\n    marginBottom: '3em'\n  }\n};\nconst checkoutButtonStyle = {\n  borderRadius: '5px',\n  color: 'white',\n  padding: '14px 24px',\n  fontSize: '20px',\n  width: '190px',\n  textTransform: 'none',\n  '&:hover': {\n    backgroundColor: 'secondary.main'\n  },\n  '@media (max-width: 750px)': {\n    width: '100%'\n  }\n};\n\nconst Main = () => {\n  _s();\n\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const auth = useSelector(state => state.auth);\n  const {\n    token,\n    isAuth\n  } = auth;\n  const checkout = useSelector(state => state.checkout);\n  const {\n    needToSave,\n    email,\n    firstName,\n    lastName,\n    address,\n    apartment\n  } = checkout;\n  const cart = useSelector(state => state.cart);\n  const {\n    cartItems\n  } = cart;\n\n  const getTotalPrice = () => {\n    const reducer = (acc, item) => acc + item.quantity * item.price * item.size;\n\n    return cartItems.reduce(reducer, 0);\n  };\n\n  let totalPrice = getTotalPrice().toFixed(2);\n  const [state, setState] = useState({\n    email: email || '',\n    errorEmail: '',\n    firstName: firstName || '',\n    errorFirstName: '',\n    lastName: lastName || '',\n    errorLastName: '',\n    address: address || '',\n    errorAddress: '',\n    apartment: apartment || '',\n    errorApartment: ''\n  });\n\n  const handleChange = e => {\n    setState({ ...state,\n      [e.target.name]: e.target.value,\n      errorEmail: e.target.name === 'email' ? '' : state.errorEmail,\n      errorFirstName: e.target.name === 'firstName' ? '' : state.errorFirstName,\n      errorLastName: e.target.name === 'lastName' ? '' : state.errorLastName,\n      errorAddress: e.target.name === 'address' ? '' : state.errorAddress,\n      errorApartment: e.target.name === 'apartment' ? '' : state.errorApartment\n    });\n  };\n\n  const handleCheck = e => {\n    dispatch(setIsChecked(e.target.checked));\n  };\n\n  const handleClick = async e => {\n    e.preventDefault();\n\n    if (emailValidation(state, setState) && anyString255Validation(state, setState, 'firstName', 'errorFirstName') && anyString255Validation(state, setState, 'lastName', 'errorLastName') && anyString255Validation(state, setState, 'address', 'errorAddress') && anyString255Validation(state, setState, 'apartment', 'errorApartment')) {\n      try {\n        if (isAuth && needToSave) {\n          const response = await axios({\n            method: 'post',\n            url: '/api/checkout',\n            headers: {\n              Authorization: token\n            },\n            data: {\n              needToSave: true,\n              totalPrice: totalPrice,\n              email: state.email,\n              firstName: state.firstName,\n              lastName: state.lastName,\n              address: state.address,\n              apartment: state.apartment,\n              orderList: cartItems\n            }\n          });\n\n          if (response.status === 201) {\n            dispatch(setDataInDb({\n              needToSave: true,\n              email: state.email,\n              firstName: state.firstName,\n              lastName: state.lastName,\n              address: state.address,\n              apartment: state.apartment\n            }));\n            dispatch(rewriteCart([]));\n            history.push('/');\n          }\n        } else if (isAuth && !needToSave) {\n          const response = await axios({\n            method: 'post',\n            url: '/api/checkout',\n            headers: {\n              Authorization: token\n            },\n            data: {\n              needToSave: false,\n              totalPrice: totalPrice,\n              email: state.email,\n              firstName: state.firstName,\n              lastName: state.lastName,\n              address: state.address,\n              apartment: state.apartment,\n              orderList: cartItems\n            }\n          });\n\n          if (response.status === 201) {\n            dispatch(setDataInDb({\n              needToSave: false,\n              email: '',\n              firstName: '',\n              lastName: '',\n              address: '',\n              apartment: ''\n            }));\n            dispatch(rewriteCart([]));\n            history.push('/');\n          }\n        } else if (!isAuth) {\n          await axios({\n            method: 'post',\n            url: '/api/checkout',\n            data: {\n              needToSave: false,\n              totalPrice: totalPrice,\n              email: state.email,\n              firstName: state.firstName,\n              lastName: state.lastName,\n              address: state.address,\n              apartment: state.apartment,\n              orderList: cartItems\n            }\n          });\n          dispatch(rewriteCart([]));\n          history.push('/');\n        }\n      } catch (err) {\n        if (axios.isAxiosError(err)) {\n          if (err && err.response) {\n            throw new Error(err.response.data.message);\n          }\n        }\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: mainStyle,\n    children: [/*#__PURE__*/_jsxDEV(Link, {\n      to: \"/\",\n      style: {\n        textDecoration: 'none',\n        color: '#333333'\n      },\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        sx: {\n          fontSize: '26px',\n          lineHeight: '1.3em',\n          paddingBottom: '28px'\n        },\n        children: \"Grocery shop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AccordionComponent, {\n      cartItems: cartItems,\n      totalPrice: totalPrice\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ContactInformation, {\n      handleChange: handleChange,\n      value: state.email,\n      error: state.errorEmail\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ShippingAddress, {\n      state: state,\n      handleChange: handleChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 7\n    }, this), isAuth ? /*#__PURE__*/_jsxDEV(SaveInformation, {\n      handleCheck: handleCheck,\n      checked: needToSave\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 9\n    }, this) : null, /*#__PURE__*/_jsxDEV(Box, {\n      sx: bottomButtons,\n      children: [/*#__PURE__*/_jsxDEV(CommonButton, {\n        sx: checkoutButtonStyle,\n        onClick: handleClick,\n        children: \"Checkout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/cart\",\n        children: \"Return to cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        padding: '14px 0px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Divider, {\n        sx: {\n          marginBottom: '14px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        sx: {\n          color: '#737373',\n          fontSize: '12px'\n        },\n        children: \"All rights reserved Grocery Shop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 231,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Main, \"7IwX4QbPiR9GlmAiO2vB1lTY/ok=\", false, function () {\n  return [useDispatch, useHistory, useSelector, useSelector, useSelector];\n});\n\n_c = Main;\nexport default Main;\n\nvar _c;\n\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"sources":["/Users/dcurchin/Desktop/final/grocery-shop-ui/src/components/checkout/Main.jsx"],"names":["Typography","Box","Divider","React","useState","Link","useHistory","ContactInformation","SaveInformation","ShippingAddress","CommonButton","useDispatch","useSelector","emailValidation","axios","anyString255Validation","setIsChecked","setDataInDb","rewriteCart","AccordionComponent","mainStyle","paddingRight","paddingTop","paddingLeft","color","width","display","flexDirection","gap","backgroundColor","bottomButtons","alignItems","marginBottom","textDecoration","justifyContent","content","checkoutButtonStyle","borderRadius","padding","fontSize","textTransform","Main","dispatch","history","auth","state","token","isAuth","checkout","needToSave","email","firstName","lastName","address","apartment","cart","cartItems","getTotalPrice","reducer","acc","item","quantity","price","size","reduce","totalPrice","toFixed","setState","errorEmail","errorFirstName","errorLastName","errorAddress","errorApartment","handleChange","e","target","name","value","handleCheck","checked","handleClick","preventDefault","response","method","url","headers","Authorization","data","orderList","status","push","err","isAxiosError","Error","message","lineHeight","paddingBottom"],"mappings":"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","sourcesContent":["import { Typography, Box, Divider } from '@mui/material';\nimport { React, useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport ContactInformation from './ContactInformation';\nimport SaveInformation from './SaveInformation';\nimport ShippingAddress from './ShippingAddress';\nimport CommonButton from '../common/buttons/CommonButton';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { emailValidation } from '../../helpers/emailValidation';\nimport axios from 'axios';\nimport { anyString255Validation } from '../../helpers/anyString255Validation';\nimport { setIsChecked, setDataInDb } from '../../redux/slices/checkoutSlice';\nimport { rewriteCart } from '../../redux/slices/cartSlice';\nimport AccordionComponent from './AccordionComponent';\n\nconst mainStyle = {\n  paddingRight: '4em',\n  paddingTop: '4em',\n  paddingLeft: '14%',\n  color: '#333333',\n  width: '55%',\n  display: 'flex',\n  flexDirection: 'column',\n  gap: '12px',\n  backgroundColor: '#fff',\n  '@media (max-width : 1000px)': {\n    width: '100%',\n    paddingTop: '1.5em',\n    paddingLeft: '15%',\n    paddingRight: '15%',\n  },\n  '@media (max-width: 750px)': {\n    display: 'block',\n  },\n};\n\nconst bottomButtons = {\n  display: 'flex',\n  alignItems: 'baseline',\n  gap: '18px',\n  marginBottom: '4em',\n  '& a': {\n    textDecoration: 'none',\n    color: 'primary.main',\n    '@media (max-width: 750px)': {\n      paddingTop: '15px',\n      width: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      '&::before': {\n        content: '\"❮\"',\n        paddingRight: '5px',\n      },\n    },\n  },\n  '@media (max-width: 750px)': {\n    display: 'block',\n    marginBottom: '3em',\n  },\n};\n\nconst checkoutButtonStyle = {\n  borderRadius: '5px',\n  color: 'white',\n  padding: '14px 24px',\n  fontSize: '20px',\n  width: '190px',\n  textTransform: 'none',\n  '&:hover': {\n    backgroundColor: 'secondary.main',\n  },\n  '@media (max-width: 750px)': {\n    width: '100%',\n  },\n};\n\nconst Main = () => {\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const auth = useSelector((state) => state.auth);\n  const { token, isAuth } = auth;\n\n  const checkout = useSelector((state) => state.checkout);\n  const { needToSave, email, firstName, lastName, address, apartment } =\n    checkout;\n\n  const cart = useSelector((state) => state.cart);\n  const { cartItems } = cart;\n\n  const getTotalPrice = () => {\n    const reducer = (acc, item) => acc + item.quantity * item.price * item.size;\n    return cartItems.reduce(reducer, 0);\n  };\n\n  let totalPrice = getTotalPrice().toFixed(2);\n\n  const [state, setState] = useState({\n    email: email || '',\n    errorEmail: '',\n    firstName: firstName || '',\n    errorFirstName: '',\n    lastName: lastName || '',\n    errorLastName: '',\n    address: address || '',\n    errorAddress: '',\n    apartment: apartment || '',\n    errorApartment: '',\n  });\n\n  const handleChange = (e) => {\n    setState({\n      ...state,\n      [e.target.name]: e.target.value,\n      errorEmail: e.target.name === 'email' ? '' : state.errorEmail,\n      errorFirstName: e.target.name === 'firstName' ? '' : state.errorFirstName,\n      errorLastName: e.target.name === 'lastName' ? '' : state.errorLastName,\n      errorAddress: e.target.name === 'address' ? '' : state.errorAddress,\n      errorApartment: e.target.name === 'apartment' ? '' : state.errorApartment,\n    });\n  };\n  const handleCheck = (e) => {\n    dispatch(setIsChecked(e.target.checked));\n  };\n  const handleClick = async (e) => {\n    e.preventDefault();\n    if (\n      emailValidation(state, setState) &&\n      anyString255Validation(state, setState, 'firstName', 'errorFirstName') &&\n      anyString255Validation(state, setState, 'lastName', 'errorLastName') &&\n      anyString255Validation(state, setState, 'address', 'errorAddress') &&\n      anyString255Validation(state, setState, 'apartment', 'errorApartment')\n    ) {\n      try {\n        if (isAuth && needToSave) {\n          const response = await axios({\n            method: 'post',\n            url: '/api/checkout',\n            headers: {\n              Authorization: token,\n            },\n            data: {\n              needToSave: true,\n              totalPrice: totalPrice,\n              email: state.email,\n              firstName: state.firstName,\n              lastName: state.lastName,\n              address: state.address,\n              apartment: state.apartment,\n              orderList: cartItems,\n            },\n          });\n\n          if (response.status === 201) {\n            dispatch(\n              setDataInDb({\n                needToSave: true,\n                email: state.email,\n                firstName: state.firstName,\n                lastName: state.lastName,\n                address: state.address,\n                apartment: state.apartment,\n              })\n            );\n            dispatch(rewriteCart([]));\n            history.push('/');\n          }\n        } else if (isAuth && !needToSave) {\n          const response = await axios({\n            method: 'post',\n            url: '/api/checkout',\n            headers: {\n              Authorization: token,\n            },\n            data: {\n              needToSave: false,\n              totalPrice: totalPrice,\n              email: state.email,\n              firstName: state.firstName,\n              lastName: state.lastName,\n              address: state.address,\n              apartment: state.apartment,\n              orderList: cartItems,\n            },\n          });\n\n          if (response.status === 201) {\n            dispatch(\n              setDataInDb({\n                needToSave: false,\n                email: '',\n                firstName: '',\n                lastName: '',\n                address: '',\n                apartment: '',\n              })\n            );\n            dispatch(rewriteCart([]));\n            history.push('/');\n          }\n        } else if (!isAuth) {\n          await axios({\n            method: 'post',\n            url: '/api/checkout',\n            data: {\n              needToSave: false,\n              totalPrice: totalPrice,\n              email: state.email,\n              firstName: state.firstName,\n              lastName: state.lastName,\n              address: state.address,\n              apartment: state.apartment,\n              orderList: cartItems,\n            },\n          });\n          dispatch(rewriteCart([]));\n          history.push('/');\n        }\n      } catch (err) {\n        if (axios.isAxiosError(err)) {\n          if (err && err.response) {\n            throw new Error(err.response.data.message);\n          }\n        }\n      }\n    }\n  };\n\n  return (\n    <Box sx={mainStyle}>\n      <Link\n        to=\"/\"\n        style={{\n          textDecoration: 'none',\n          color: '#333333',\n        }}\n      >\n        <Typography\n          sx={{ fontSize: '26px', lineHeight: '1.3em', paddingBottom: '28px' }}\n        >\n          Grocery shop\n        </Typography>\n      </Link>\n\n      <AccordionComponent cartItems={cartItems} totalPrice={totalPrice} />\n\n      <ContactInformation\n        handleChange={handleChange}\n        value={state.email}\n        error={state.errorEmail}\n      />\n      <ShippingAddress state={state} handleChange={handleChange} />\n      {isAuth ? (\n        <SaveInformation handleCheck={handleCheck} checked={needToSave} />\n      ) : null}\n\n      <Box sx={bottomButtons}>\n        <CommonButton sx={checkoutButtonStyle} onClick={handleClick}>\n          Checkout\n        </CommonButton>\n\n        <Link to=\"/cart\">Return to cart</Link>\n      </Box>\n      <Box sx={{ padding: '14px 0px' }}>\n        <Divider sx={{ marginBottom: '14px' }} />\n        <Typography sx={{ color: '#737373', fontSize: '12px' }}>\n          All rights reserved Grocery Shop\n        </Typography>\n      </Box>\n    </Box>\n  );\n};\n\nexport default Main;\n"]},"metadata":{},"sourceType":"module"}