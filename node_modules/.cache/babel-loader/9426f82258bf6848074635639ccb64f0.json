{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { ColumnSeries } from \"./ColumnSeries\";\nimport { Candlestick } from \"./Candlestick\";\nimport { Template } from \"../../../core/util/Template\";\nimport { ListTemplate } from \"../../../core/util/List\";\nimport * as $utils from \"../../../core/util/Utils\";\nimport * as $array from \"../../../core/util/Array\";\n/**\r\n * Candlestick series.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\r\n * @important\r\n */\n\nvar CandlestickSeries =\n/** @class */\nfunction (_super) {\n  __extends(CandlestickSeries, _super);\n\n  function CandlestickSeries() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    /**\r\n     * A list of candles in the series.\r\n     *\r\n     * `columns.template` can be used to configure candles.\r\n     *\r\n     * @default new ListTemplate<Candlestick>\r\n     */\n\n\n    Object.defineProperty(_this, \"columns\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: new ListTemplate(Template.new({\n        themeTags: [\"autocolor\"]\n      }), function () {\n        return Candlestick._new(_this._root, {\n          themeTags: $utils.mergeTags(_this.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"])\n        }, [_this.columns.template]);\n      })\n    });\n    return _this;\n  }\n\n  Object.defineProperty(CandlestickSeries.prototype, \"_afterNew\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this.valueFields.push(\"lowValueX\", \"lowValueY\", \"highValueX\", \"highValueY\");\n      this.valueXFields.push(\"lowValueX\", \"highValueX\");\n      this.valueYFields.push(\"lowValueY\", \"highValueY\");\n\n      this._setRawDefault(\"lowValueXShow\", \"lowValueXWorking\");\n\n      this._setRawDefault(\"lowValueYShow\", \"lowValueYWorking\");\n\n      this._setRawDefault(\"highValueXShow\", \"highValueXWorking\");\n\n      this._setRawDefault(\"highValueYShow\", \"highValueYWorking\");\n\n      this._setRawDefault(\"lowValueXGrouped\", \"low\");\n\n      this._setRawDefault(\"lowValueYGrouped\", \"low\");\n\n      this._setRawDefault(\"highValueXGrouped\", \"high\");\n\n      this._setRawDefault(\"highValueYGrouped\", \"high\");\n\n      _super.prototype._afterNew.call(this);\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(CandlestickSeries.prototype, \"makeColumn\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, listTemplate) {\n      var column = this.mainContainer.children.push(listTemplate.make());\n\n      column._setDataItem(dataItem);\n\n      listTemplate.push(column);\n      return column;\n    }\n  });\n  Object.defineProperty(CandlestickSeries.prototype, \"_updateGraphics\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, previousDataItem) {\n      _super.prototype._updateGraphics.call(this, dataItem, previousDataItem);\n\n      var xAxis = this.getRaw(\"xAxis\");\n      var yAxis = this.getRaw(\"yAxis\");\n      var baseAxis = this.getRaw(\"baseAxis\");\n      var vcy = this.get(\"vcy\", 1);\n      var vcx = this.get(\"vcx\", 1);\n      var lx0;\n      var lx1;\n      var ly0;\n      var ly1;\n      var hx0;\n      var hx1;\n      var hy0;\n      var hy1;\n      var locationX = this.get(\"locationX\", dataItem.get(\"locationX\", 0.5));\n      var locationY = this.get(\"locationY\", dataItem.get(\"locationY\", 0.5));\n      var openLocationX = this.get(\"openLocationX\", dataItem.get(\"openLocationX\", locationX));\n      var openLocationY = this.get(\"openLocationY\", dataItem.get(\"openLocationY\", locationY));\n      var orientation;\n\n      if (yAxis === baseAxis) {\n        var open_1 = xAxis.getDataItemPositionX(dataItem, this._xOpenField, 1, vcx);\n        var close_1 = xAxis.getDataItemPositionX(dataItem, this._xField, 1, vcx);\n        lx1 = xAxis.getDataItemPositionX(dataItem, this._xLowField, 1, vcx);\n        hx1 = xAxis.getDataItemPositionX(dataItem, this._xHighField, 1, vcx);\n        hx0 = Math.max(open_1, close_1);\n        lx0 = Math.min(open_1, close_1);\n        var startLocation = this._aLocationY0 + openLocationY - 0.5;\n        var endLocation = this._aLocationY1 + locationY - 0.5;\n        ly0 = yAxis.getDataItemPositionY(dataItem, this._yField, startLocation + (endLocation - startLocation) / 2, vcy);\n        ly1 = ly0;\n        hy0 = ly0;\n        hy1 = ly0;\n        orientation = \"horizontal\";\n      } else {\n        var open_2 = yAxis.getDataItemPositionY(dataItem, this._yOpenField, 1, vcy);\n        var close_2 = yAxis.getDataItemPositionY(dataItem, this._yField, 1, vcy);\n        ly1 = yAxis.getDataItemPositionY(dataItem, this._yLowField, 1, vcy);\n        hy1 = yAxis.getDataItemPositionY(dataItem, this._yHighField, 1, vcy);\n        hy0 = Math.max(open_2, close_2);\n        ly0 = Math.min(open_2, close_2);\n        var startLocation = this._aLocationX0 + openLocationX - 0.5;\n        var endLocation = this._aLocationX1 + locationX - 0.5;\n        lx0 = xAxis.getDataItemPositionX(dataItem, this._xField, startLocation + (endLocation - startLocation) / 2, vcx);\n        lx1 = lx0;\n        hx0 = lx0;\n        hx1 = lx0;\n        orientation = \"vertical\";\n      }\n\n      this._updateCandleGraphics(dataItem, lx0, lx1, ly0, ly1, hx0, hx1, hy0, hy1, orientation);\n    }\n  });\n  Object.defineProperty(CandlestickSeries.prototype, \"_updateCandleGraphics\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, lx0, lx1, ly0, ly1, hx0, hx1, hy0, hy1, orientation) {\n      var column = dataItem.get(\"graphics\");\n\n      if (column) {\n        var pl0_1 = this.getPoint(lx0, ly0);\n        var pl1_1 = this.getPoint(lx1, ly1);\n        var ph0_1 = this.getPoint(hx0, hy0);\n        var ph1_1 = this.getPoint(hx1, hy1);\n        var x_1 = column.x();\n        var y_1 = column.y();\n        column.set(\"lowX0\", pl0_1.x - x_1);\n        column.set(\"lowY0\", pl0_1.y - y_1);\n        column.set(\"lowX1\", pl1_1.x - x_1);\n        column.set(\"lowY1\", pl1_1.y - y_1);\n        column.set(\"highX0\", ph0_1.x - x_1);\n        column.set(\"highY0\", ph0_1.y - y_1);\n        column.set(\"highX1\", ph1_1.x - x_1);\n        column.set(\"highY1\", ph1_1.y - y_1);\n        column.set(\"orientation\", orientation);\n        var rangeGraphics = dataItem.get(\"rangeGraphics\");\n\n        if (rangeGraphics) {\n          $array.each(rangeGraphics, function (column) {\n            column.set(\"lowX0\", pl0_1.x - x_1);\n            column.set(\"lowY0\", pl0_1.y - y_1);\n            column.set(\"lowX1\", pl1_1.x - x_1);\n            column.set(\"lowY1\", pl1_1.y - y_1);\n            column.set(\"highX0\", ph0_1.x - x_1);\n            column.set(\"highY0\", ph0_1.y - y_1);\n            column.set(\"highX1\", ph1_1.x - x_1);\n            column.set(\"highY1\", ph1_1.y - y_1);\n            column.set(\"orientation\", orientation);\n          });\n        }\n      }\n    }\n  });\n  Object.defineProperty(CandlestickSeries.prototype, \"_processAxisRange\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (axisRange) {\n      var _this = this;\n\n      _super.prototype._processAxisRange.call(this, axisRange);\n\n      axisRange.columns = new ListTemplate(Template.new({}), function () {\n        return Candlestick._new(_this._root, {\n          themeTags: $utils.mergeTags(axisRange.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"])\n        }, [_this.columns.template, axisRange.columns.template]);\n      });\n    }\n  });\n  Object.defineProperty(CandlestickSeries, \"className\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: \"CandlestickSeries\"\n  });\n  Object.defineProperty(CandlestickSeries, \"classNames\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: ColumnSeries.classNames.concat([CandlestickSeries.className])\n  });\n  return CandlestickSeries;\n}(ColumnSeries);\n\nexport { CandlestickSeries };","map":{"version":3,"sources":["../../../../../../src/.internal/charts/xy/series/CandlestickSeries.ts"],"names":[],"mappings":";AAAA,SAAS,YAAT,QAAyH,gBAAzH;AAEA,SAAS,WAAT,QAA4B,eAA5B;AACA,SAAS,QAAT,QAAyB,6BAAzB;AACA,SAAS,YAAT,QAA6B,yBAA7B;AACA,OAAO,KAAK,MAAZ,MAAwB,0BAAxB;AACA,OAAO,KAAK,MAAZ,MAAwB,0BAAxB;AAwNA;;;;;AAKG;;AACH,IAAA,iBAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAuC,EAAA,SAAA,CAAA,iBAAA,EAAA,MAAA,CAAA;;AAAvC,WAAA,iBAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;AAwCC;;;;;;AAMG;;;AACH,IAAA,MAAA,CAAA,cAAA,CAAA,KAAA,EAAA,SAAA,EAAA;sBAAA;wBAAA;oBAAA;aAAqD,IAAI,YAAJ,CACpD,QAAQ,CAAC,GAAT,CAAa;AACZ,QAAA,SAAS,EAAE,CAAC,WAAD;AADC,OAAb,CADoD,EAIpD,YAAA;AAAM,eAAA,WAAW,CAAC,IAAZ,CAAiB,KAAI,CAAC,KAAtB,EAA6B;AAClC,UAAA,SAAS,EAAE,MAAM,CAAC,SAAP,CAAiB,KAAI,CAAC,OAAL,CAAa,QAAb,CAAsB,GAAtB,CAA0B,WAA1B,EAAuC,EAAvC,CAAjB,EAA6D,CAAC,aAAD,EAAgB,QAAhB,EAA0B,QAA1B,CAA7D;AADuB,SAA7B,EAEH,CAAC,KAAI,CAAC,OAAL,CAFE,QAEH,CAFG,CAAA;AAEqB,OANyB;AAArD,KAAA;;AA0IA;;;;;;WA/KA,YAAA;AACC,WAAK,WAAL,CAAiB,IAAjB,CAAsB,WAAtB,EAAmC,WAAnC,EAAgD,YAAhD,EAA8D,YAA9D;AACA,WAAK,YAAL,CAAkB,IAAlB,CAAuB,WAAvB,EAAoC,YAApC;AACA,WAAK,YAAL,CAAkB,IAAlB,CAAuB,WAAvB,EAAoC,YAApC;;AAEA,WAAK,cAAL,CAAoB,eAApB,EAAqC,kBAArC;;AACA,WAAK,cAAL,CAAoB,eAApB,EAAqC,kBAArC;;AAEA,WAAK,cAAL,CAAoB,gBAApB,EAAsC,mBAAtC;;AACA,WAAK,cAAL,CAAoB,gBAApB,EAAsC,mBAAtC;;AAEA,WAAK,cAAL,CAAoB,kBAApB,EAAwC,KAAxC;;AACA,WAAK,cAAL,CAAoB,kBAApB,EAAwC,KAAxC;;AAEA,WAAK,cAAL,CAAoB,mBAApB,EAAyC,MAAzC;;AACA,WAAK,cAAL,CAAoB,mBAApB,EAAyC,MAAzC;;AAEA,MAAA,MAAA,CAAA,SAAA,CAAM,SAAN,CAAe,IAAf,CAAe,IAAf;AACA;;AAED;;AAEG;;;;;;WACH,UAAkB,QAAlB,EAAiE,YAAjE,EAAwG;AACvG,UAAM,MAAM,GAAG,KAAK,aAAL,CAAmB,QAAnB,CAA4B,IAA5B,CAAiC,YAAY,CAAC,IAAb,EAAjC,CAAf;;AACA,MAAA,MAAM,CAAC,YAAP,CAAoB,QAApB;;AACA,MAAA,YAAY,CAAC,IAAb,CAAkB,MAAlB;AACA,aAAO,MAAP;AACA;;;;;;WAkBD,UAA0B,QAA1B,EAAyE,gBAAzE,EAA8H;AAC7H,MAAA,MAAA,CAAA,SAAA,CAAM,eAAN,CAAqB,IAArB,CAAqB,IAArB,EAAsB,QAAtB,EAAgC,gBAAhC;;AAEA,UAAM,KAAK,GAAG,KAAK,MAAL,CAAY,OAAZ,CAAd;AACA,UAAM,KAAK,GAAG,KAAK,MAAL,CAAY,OAAZ,CAAd;AACA,UAAM,QAAQ,GAAG,KAAK,MAAL,CAAY,UAAZ,CAAjB;AAEA,UAAI,GAAG,GAAG,KAAK,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAV;AACA,UAAI,GAAG,GAAG,KAAK,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAV;AAEA,UAAI,GAAJ;AACA,UAAI,GAAJ;AACA,UAAI,GAAJ;AACA,UAAI,GAAJ;AAEA,UAAI,GAAJ;AACA,UAAI,GAAJ;AACA,UAAI,GAAJ;AACA,UAAI,GAAJ;AAEA,UAAI,SAAS,GAAG,KAAK,GAAL,CAAS,WAAT,EAAsB,QAAQ,CAAC,GAAT,CAAa,WAAb,EAA0B,GAA1B,CAAtB,CAAhB;AACA,UAAI,SAAS,GAAG,KAAK,GAAL,CAAS,WAAT,EAAsB,QAAQ,CAAC,GAAT,CAAa,WAAb,EAA0B,GAA1B,CAAtB,CAAhB;AAEA,UAAI,aAAa,GAAG,KAAK,GAAL,CAAS,eAAT,EAA0B,QAAQ,CAAC,GAAT,CAAa,eAAb,EAA8B,SAA9B,CAA1B,CAApB;AACA,UAAI,aAAa,GAAG,KAAK,GAAL,CAAS,eAAT,EAA0B,QAAQ,CAAC,GAAT,CAAa,eAAb,EAA8B,SAA9B,CAA1B,CAApB;AAEA,UAAI,WAAJ;;AAEA,UAAI,KAAK,KAAK,QAAd,EAAwB;AACvB,YAAI,MAAI,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,WAA1C,EAAuD,CAAvD,EAA0D,GAA1D,CAAX;AACA,YAAI,OAAK,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,OAA1C,EAAmD,CAAnD,EAAsD,GAAtD,CAAZ;AAEA,QAAA,GAAG,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,UAA1C,EAAsD,CAAtD,EAAyD,GAAzD,CAAN;AACA,QAAA,GAAG,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,WAA1C,EAAuD,CAAvD,EAA0D,GAA1D,CAAN;AAEA,QAAA,GAAG,GAAG,IAAI,CAAC,GAAL,CAAS,MAAT,EAAe,OAAf,CAAN;AACA,QAAA,GAAG,GAAG,IAAI,CAAC,GAAL,CAAS,MAAT,EAAe,OAAf,CAAN;AAEA,YAAI,aAAa,GAAG,KAAK,YAAL,GAAoB,aAApB,GAAoC,GAAxD;AACA,YAAI,WAAW,GAAG,KAAK,YAAL,GAAoB,SAApB,GAAgC,GAAlD;AAEA,QAAA,GAAG,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,OAA1C,EAAmD,aAAa,GAAG,CAAC,WAAW,GAAG,aAAf,IAAgC,CAAnG,EAAsG,GAAtG,CAAN;AACA,QAAA,GAAG,GAAG,GAAN;AACA,QAAA,GAAG,GAAG,GAAN;AACA,QAAA,GAAG,GAAG,GAAN;AAEA,QAAA,WAAW,GAAG,YAAd;AACA,OAnBD,MAoBK;AACJ,YAAI,MAAI,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,WAA1C,EAAuD,CAAvD,EAA0D,GAA1D,CAAX;AACA,YAAI,OAAK,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,OAA1C,EAAmD,CAAnD,EAAsD,GAAtD,CAAZ;AAEA,QAAA,GAAG,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,UAA1C,EAAsD,CAAtD,EAAyD,GAAzD,CAAN;AACA,QAAA,GAAG,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,WAA1C,EAAuD,CAAvD,EAA0D,GAA1D,CAAN;AAEA,QAAA,GAAG,GAAG,IAAI,CAAC,GAAL,CAAS,MAAT,EAAe,OAAf,CAAN;AACA,QAAA,GAAG,GAAG,IAAI,CAAC,GAAL,CAAS,MAAT,EAAe,OAAf,CAAN;AAEA,YAAI,aAAa,GAAG,KAAK,YAAL,GAAoB,aAApB,GAAoC,GAAxD;AACA,YAAI,WAAW,GAAG,KAAK,YAAL,GAAoB,SAApB,GAAgC,GAAlD;AAEA,QAAA,GAAG,GAAG,KAAK,CAAC,oBAAN,CAA2B,QAA3B,EAAqC,KAAK,OAA1C,EAAmD,aAAa,GAAG,CAAC,WAAW,GAAG,aAAf,IAAgC,CAAnG,EAAsG,GAAtG,CAAN;AACA,QAAA,GAAG,GAAG,GAAN;AACA,QAAA,GAAG,GAAG,GAAN;AACA,QAAA,GAAG,GAAG,GAAN;AAEA,QAAA,WAAW,GAAG,UAAd;AACA;;AAED,WAAK,qBAAL,CAA2B,QAA3B,EAAqC,GAArC,EAA0C,GAA1C,EAA+C,GAA/C,EAAoD,GAApD,EAAyD,GAAzD,EAA8D,GAA9D,EAAmE,GAAnE,EAAwE,GAAxE,EAA6E,WAA7E;AACA;;;;;;WAED,UAAgC,QAAhC,EAA+E,GAA/E,EAA4F,GAA5F,EAAyG,GAAzG,EAAsH,GAAtH,EAAmI,GAAnI,EAAgJ,GAAhJ,EAA6J,GAA7J,EAA0K,GAA1K,EAAuL,WAAvL,EAA6N;AAC5N,UAAI,MAAM,GAAG,QAAQ,CAAC,GAAT,CAAa,UAAb,CAAb;;AAEA,UAAI,MAAJ,EAAY;AACX,YAAI,KAAG,GAAG,KAAK,QAAL,CAAc,GAAd,EAAmB,GAAnB,CAAV;AACA,YAAI,KAAG,GAAG,KAAK,QAAL,CAAc,GAAd,EAAmB,GAAnB,CAAV;AAEA,YAAI,KAAG,GAAG,KAAK,QAAL,CAAc,GAAd,EAAmB,GAAnB,CAAV;AACA,YAAI,KAAG,GAAG,KAAK,QAAL,CAAc,GAAd,EAAmB,GAAnB,CAAV;AAEA,YAAI,GAAC,GAAG,MAAM,CAAC,CAAP,EAAR;AACA,YAAI,GAAC,GAAG,MAAM,CAAC,CAAP,EAAR;AAEA,QAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AACA,QAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AAEA,QAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AACA,QAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AAEA,QAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AACA,QAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AAEA,QAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AACA,QAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AAEA,QAAA,MAAM,CAAC,GAAP,CAAW,aAAX,EAA0B,WAA1B;AAEA,YAAI,aAAa,GAAG,QAAQ,CAAC,GAAT,CAAa,eAAb,CAApB;;AACA,YAAI,aAAJ,EAAmB;AAClB,UAAA,MAAM,CAAC,IAAP,CAAY,aAAZ,EAA2B,UAAC,MAAD,EAAY;AACtC,YAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AACA,YAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AAEA,YAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AACA,YAAA,MAAM,CAAC,GAAP,CAAW,OAAX,EAAoB,KAAG,CAAC,CAAJ,GAAQ,GAA5B;AAEA,YAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AACA,YAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AAEA,YAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AACA,YAAA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,KAAG,CAAC,CAAJ,GAAQ,GAA7B;AAEA,YAAA,MAAM,CAAC,GAAP,CAAW,aAAX,EAA0B,WAA1B;AACA,WAdD;AAeA;AACD;AACD;;;;;;WAED,UAA4B,SAA5B,EAA6D;AAA7D,UAAA,KAAA,GAAA,IAAA;;AACC,MAAA,MAAA,CAAA,SAAA,CAAM,iBAAN,CAAuB,IAAvB,CAAuB,IAAvB,EAAwB,SAAxB;;AACA,MAAA,SAAS,CAAC,OAAV,GAAoB,IAAI,YAAJ,CACnB,QAAQ,CAAC,GAAT,CAAa,EAAb,CADmB,EAEnB,YAAA;AAAM,eAAA,WAAW,CAAC,IAAZ,CAAiB,KAAI,CAAC,KAAtB,EAA6B;AAClC,UAAA,SAAS,EAAE,MAAM,CAAC,SAAP,CAAiB,SAAS,CAAC,OAAV,CAAkB,QAAlB,CAA2B,GAA3B,CAA+B,WAA/B,EAA4C,EAA5C,CAAjB,EAAkE,CAAC,aAAD,EAAgB,QAAhB,EAA0B,QAA1B,CAAlE;AADuB,SAA7B,EAEH,CAAC,KAAI,CAAC,OAAL,CAAa,QAAd,EAAwB,SAAS,CAAC,OAAV,CAFrB,QAEH,CAFG,CAAA;AAEiD,OAJpC,CAApB;AAMA;;AAjLD,EAAA,MAAA,CAAA,cAAA,CAAA,iBAAA,EAAA,WAAA,EAAA;oBAAA;sBAAA;kBAAA;WAAkC;AAAlC,GAAA;AACA,EAAA,MAAA,CAAA,cAAA,CAAA,iBAAA,EAAA,YAAA,EAAA;oBAAA;sBAAA;kBAAA;WAA0C,YAAY,CAAC,UAAb,CAAwB,MAAxB,CAA+B,CAAC,iBAAiB,CAAC,SAAnB,CAA/B;AAA1C,GAAA;AAiLD,SAAA,iBAAA;AAAC,CAzLD,CAAuC,YAAvC,CAAA;;SAAa,iB","sourcesContent":["import { ColumnSeries, IColumnSeriesPrivate, IColumnSeriesSettings, IColumnSeriesDataItem, IColumnSeriesAxisRange } from \"./ColumnSeries\";\nimport type { DataItem } from \"../../../core/render/Component\";\nimport { Candlestick } from \"./Candlestick\";\nimport { Template } from \"../../../core/util/Template\";\nimport { ListTemplate } from \"../../../core/util/List\";\nimport * as $utils from \"../../../core/util/Utils\";\nimport * as $array from \"../../../core/util/Array\";\n\nexport interface ICandlestickSeriesDataItem extends IColumnSeriesDataItem {\n\tlowValueX?: number;\n\tlowValueXWorking?: number;\n\tlowValueXChange?: number;\n\tlowValueXChangePercent?: number;\n\tlowValueXChangeSelection?: number;\n\tlowValueXChangeSelectionPercent?: number;\n\tlowValueXChangePrevious?: number;\n\tlowValueXChangePreviousPercent?: number;\n\tlowValueXWorkingOpen?: number;\n\tlowValueXWorkingClose?: number;\n\n\thighValueY?: number;\n\thighValueYWorking?: number;\n\thighValueYChange?: number;\n\thighValueYChangePercent?: number;\n\thighValueYChangeSelection?: number;\n\thighValueYChangeSelectionPercent?: number;\n\thighValueYChangePrevious?: number;\n\thighValueYChangePreviousPercent?: number;\n\thighValueYWorkingOpen?: number;\n\thighValueYWorkingClose?: number;\n}\n\nexport interface ICandlestickSeriesSettings extends IColumnSeriesSettings {\n\n\t/**\n\t * Input data field for X low value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\tlowValueXField?: string;\n\n\t/**\n\t * Input data field for Y low value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\tlowValueYField?: string;\n\n\t/**\n\t * Input data field for X high value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\thighValueXField?: string;\n\n\t/**\n\t * Input data field for Y high value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\thighValueYField?: string;\n\n\t/**\n\t * Display data field for X low value.\n\t */\n\tlowValueXShow?: \"lowValueXWorking\" | \"lowValueXChange\" | \"lowValueXChangePercent\" | \"lowValueXChangeSelection\" | \"lowValueXChangeSelectionPercent\" | \"lowValueXChangePrevious\" | \"lowValueXChangePreviousPercent\";\n\n\t/**\n\t * Display data field for Y low value.\n\t */\n\tlowValueYShow?: \"lowValueYWorking\" | \"lowValueYChange\" | \"lowValueYChangePercent\" | \"lowValueYChangeSelection\" | \"lowValueYChangeSelectionPercent\" | \"lowValueYChangePrevious\" | \"lowValueYChangePreviousPercent\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X low values from several data items.\n\t */\n\tlowValueXGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating Y low values from several data items.\n\t */\n\tlowValueYGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Display data field for X high value.\n\t */\n\thighValueXShow?: \"highValueXWorking\" | \"highValueXChange\" | \"highValueXChangePercent\" | \"highValueXChangeSelection\" | \"highValueXChangeSelectionPercent\" | \"highValueXChangePrevious\" | \"highValueXChangePreviousPercent\";\n\n\t/**\n\t * Display data field for Y low value.\n\t */\n\thighValueYShow?: \"highValueYWorking\" | \"highValueYChange\" | \"highValueYChangePercent\" | \"highValueYChangeSelection\" | \"highValueYChangeSelectionPercent\" | \"highValueYChangePrevious\" | \"highValueYChangePreviousPercent\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X high values from several data items.\n\t */\n\thighValueXGrouped?: \"open\" | \"close\" | \"high\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X high values from several data items.\n\t */\n\thighValueYGrouped?: \"open\" | \"close\" | \"high\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Horizontal location of the low data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\tlowLocationX?: number;\n\n\t/**\n\t * Vertical location of the low data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\tlowLocationY?: number;\n\n\t/**\n\t * Horizontal location of the high data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\thighLocationX?: number;\n\n\t/**\n\t * Vertical location of the high data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\thighLocationY?: number;\n\n}\n\nexport interface ICandlestickSeriesPrivate extends IColumnSeriesPrivate {\n\tlowValueXAverage?: number;\n\tlowValueXCount?: number;\n\tlowValueXSum?: number;\n\tlowValueXAbsoluteSum?: number;\n\tlowValueXLow?: number;\n\tlowValueXHigh?: number;\n\tlowValueXlow?: number;\n\tlowValueXClose?: number;\n\n\tlowValueYAverage?: number;\n\tlowValueYCount?: number;\n\tlowValueYSum?: number;\n\tlowValueYAbsoluteSum?: number;\n\tlowValueYLow?: number;\n\tlowValueYHigh?: number;\n\tlowValueYlow?: number;\n\tlowValueYClose?: number;\n\n\tlowValueXAverageSelection?: number;\n\tlowValueXCountSelection?: number;\n\tlowValueXSumSelection?: number;\n\tlowValueXAbsoluteSumSelection?: number;\n\tlowValueXLowSelection?: number;\n\tlowValueXHighSelection?: number;\n\tlowValueXlowSelection?: number;\n\tlowValueXCloseSelection?: number;\n\n\tlowValueYAverageSelection?: number;\n\tlowValueYCountSelection?: number;\n\tlowValueYSumSelection?: number;\n\tlowValueYAbsoluteSumSelection?: number;\n\tlowValueYLowSelection?: number;\n\tlowValueYHighSelection?: number;\n\tlowValueYlowSelection?: number;\n\tlowValueYCloseSelection?: number;\n\n\thighValueXAverage?: number;\n\thighValueXCount?: number;\n\thighValueXSum?: number;\n\thighValueXAbsoluteSum?: number;\n\thighValueXLow?: number;\n\thighValueXHigh?: number;\n\thighValueXhigh?: number;\n\thighValueXClose?: number;\n\n\thighValueYAverage?: number;\n\thighValueYCount?: number;\n\thighValueYSum?: number;\n\thighValueYAbsoluteSum?: number;\n\thighValueYLow?: number;\n\thighValueYHigh?: number;\n\thighValueYhigh?: number;\n\thighValueYClose?: number;\n\n\thighValueXAverageSelection?: number;\n\thighValueXCountSelection?: number;\n\thighValueXSumSelection?: number;\n\thighValueXAbsoluteSumSelection?: number;\n\thighValueXLowSelection?: number;\n\thighValueXHighSelection?: number;\n\thighValueXhighSelection?: number;\n\thighValueXCloseSelection?: number;\n\n\thighValueYAverageSelection?: number;\n\thighValueYCountSelection?: number;\n\thighValueYSumSelection?: number;\n\thighValueYAbsoluteSumSelection?: number;\n\thighValueYLowSelection?: number;\n\thighValueYHighSelection?: number;\n\thighValueYhighSelection?: number;\n\thighValueYCloseSelection?: number;\n}\n\nexport interface ICandlestickSeriesAxisRange extends IColumnSeriesAxisRange {\n\tcolumns: ListTemplate<Candlestick>\n}\n\n/**\n * Candlestick series.\n *\n * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n * @important\n */\nexport class CandlestickSeries extends ColumnSeries {\n\n\tdeclare public _settings: ICandlestickSeriesSettings;\n\tdeclare public _privateSettings: ICandlestickSeriesPrivate;\n\tdeclare public _dataItemSettings: ICandlestickSeriesDataItem;\n\tdeclare public _axisRangeType: ICandlestickSeriesAxisRange;\n\n\tpublic static className: string = \"CandlestickSeries\";\n\tpublic static classNames: Array<string> = ColumnSeries.classNames.concat([CandlestickSeries.className]);\n\n\tprotected _afterNew() {\n\t\tthis.valueFields.push(\"lowValueX\", \"lowValueY\", \"highValueX\", \"highValueY\");\n\t\tthis.valueXFields.push(\"lowValueX\", \"highValueX\");\n\t\tthis.valueYFields.push(\"lowValueY\", \"highValueY\");\n\n\t\tthis._setRawDefault(\"lowValueXShow\", \"lowValueXWorking\");\n\t\tthis._setRawDefault(\"lowValueYShow\", \"lowValueYWorking\");\n\n\t\tthis._setRawDefault(\"highValueXShow\", \"highValueXWorking\");\n\t\tthis._setRawDefault(\"highValueYShow\", \"highValueYWorking\");\n\n\t\tthis._setRawDefault(\"lowValueXGrouped\", \"low\");\n\t\tthis._setRawDefault(\"lowValueYGrouped\", \"low\");\n\n\t\tthis._setRawDefault(\"highValueXGrouped\", \"high\");\n\t\tthis._setRawDefault(\"highValueYGrouped\", \"high\");\n\n\t\tsuper._afterNew();\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic makeColumn(dataItem: DataItem<this[\"_dataItemSettings\"]>, listTemplate: ListTemplate<Candlestick>): Candlestick {\n\t\tconst column = this.mainContainer.children.push(listTemplate.make());\n\t\tcolumn._setDataItem(dataItem);\n\t\tlistTemplate.push(column);\n\t\treturn column;\n\t}\n\n\t/**\n\t * A list of candles in the series.\n\t *\n\t * `columns.template` can be used to configure candles.\n\t *\n\t * @default new ListTemplate<Candlestick>\n\t */\n\tpublic readonly columns: ListTemplate<Candlestick> = new ListTemplate(\n\t\tTemplate.new({\n\t\t\tthemeTags: [\"autocolor\"]\n\t\t}),\n\t\t() => Candlestick._new(this._root, {\n\t\t\tthemeTags: $utils.mergeTags(this.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"])\n\t\t}, [this.columns.template])\n\t);\n\n\tprotected _updateGraphics(dataItem: DataItem<this[\"_dataItemSettings\"]>, previousDataItem: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tsuper._updateGraphics(dataItem, previousDataItem);\n\n\t\tconst xAxis = this.getRaw(\"xAxis\");\n\t\tconst yAxis = this.getRaw(\"yAxis\");\n\t\tconst baseAxis = this.getRaw(\"baseAxis\");\n\n\t\tlet vcy = this.get(\"vcy\", 1);\n\t\tlet vcx = this.get(\"vcx\", 1);\n\n\t\tlet lx0: number;\n\t\tlet lx1: number;\n\t\tlet ly0: number;\n\t\tlet ly1: number;\n\n\t\tlet hx0: number;\n\t\tlet hx1: number;\n\t\tlet hy0: number;\n\t\tlet hy1: number;\n\n\t\tlet locationX = this.get(\"locationX\", dataItem.get(\"locationX\", 0.5));\n\t\tlet locationY = this.get(\"locationY\", dataItem.get(\"locationY\", 0.5));\n\n\t\tlet openLocationX = this.get(\"openLocationX\", dataItem.get(\"openLocationX\", locationX));\n\t\tlet openLocationY = this.get(\"openLocationY\", dataItem.get(\"openLocationY\", locationY));\n\n\t\tlet orientation: \"horizontal\" | \"vertical\";\n\n\t\tif (yAxis === baseAxis) {\n\t\t\tlet open = xAxis.getDataItemPositionX(dataItem, this._xOpenField, 1, vcx);\n\t\t\tlet close = xAxis.getDataItemPositionX(dataItem, this._xField, 1, vcx);\n\n\t\t\tlx1 = xAxis.getDataItemPositionX(dataItem, this._xLowField, 1, vcx);\n\t\t\thx1 = xAxis.getDataItemPositionX(dataItem, this._xHighField, 1, vcx);\n\n\t\t\thx0 = Math.max(open, close);\n\t\t\tlx0 = Math.min(open, close);\n\n\t\t\tlet startLocation = this._aLocationY0 + openLocationY - 0.5;\n\t\t\tlet endLocation = this._aLocationY1 + locationY - 0.5;\n\n\t\t\tly0 = yAxis.getDataItemPositionY(dataItem, this._yField, startLocation + (endLocation - startLocation) / 2, vcy);\n\t\t\tly1 = ly0;\n\t\t\thy0 = ly0;\n\t\t\thy1 = ly0;\n\n\t\t\torientation = \"horizontal\";\n\t\t}\n\t\telse {\n\t\t\tlet open = yAxis.getDataItemPositionY(dataItem, this._yOpenField, 1, vcy);\n\t\t\tlet close = yAxis.getDataItemPositionY(dataItem, this._yField, 1, vcy);\n\n\t\t\tly1 = yAxis.getDataItemPositionY(dataItem, this._yLowField, 1, vcy);\n\t\t\thy1 = yAxis.getDataItemPositionY(dataItem, this._yHighField, 1, vcy);\n\n\t\t\thy0 = Math.max(open, close);\n\t\t\tly0 = Math.min(open, close);\n\n\t\t\tlet startLocation = this._aLocationX0 + openLocationX - 0.5;\n\t\t\tlet endLocation = this._aLocationX1 + locationX - 0.5;\n\n\t\t\tlx0 = xAxis.getDataItemPositionX(dataItem, this._xField, startLocation + (endLocation - startLocation) / 2, vcx);\n\t\t\tlx1 = lx0;\n\t\t\thx0 = lx0;\n\t\t\thx1 = lx0;\n\n\t\t\torientation = \"vertical\";\n\t\t}\n\n\t\tthis._updateCandleGraphics(dataItem, lx0, lx1, ly0, ly1, hx0, hx1, hy0, hy1, orientation)\n\t}\n\n\tprotected _updateCandleGraphics(dataItem: DataItem<this[\"_dataItemSettings\"]>, lx0: number, lx1: number, ly0: number, ly1: number, hx0: number, hx1: number, hy0: number, hy1: number, orientation: \"horizontal\" | \"vertical\") {\n\t\tlet column = dataItem.get(\"graphics\") as Candlestick;\n\n\t\tif (column) {\n\t\t\tlet pl0 = this.getPoint(lx0, ly0);\n\t\t\tlet pl1 = this.getPoint(lx1, ly1);\n\n\t\t\tlet ph0 = this.getPoint(hx0, hy0);\n\t\t\tlet ph1 = this.getPoint(hx1, hy1);\n\n\t\t\tlet x = column.x();\n\t\t\tlet y = column.y();\n\n\t\t\tcolumn.set(\"lowX0\", pl0.x - x);\n\t\t\tcolumn.set(\"lowY0\", pl0.y - y);\n\n\t\t\tcolumn.set(\"lowX1\", pl1.x - x);\n\t\t\tcolumn.set(\"lowY1\", pl1.y - y);\n\n\t\t\tcolumn.set(\"highX0\", ph0.x - x);\n\t\t\tcolumn.set(\"highY0\", ph0.y - y);\n\n\t\t\tcolumn.set(\"highX1\", ph1.x - x);\n\t\t\tcolumn.set(\"highY1\", ph1.y - y);\n\n\t\t\tcolumn.set(\"orientation\", orientation);\n\n\t\t\tlet rangeGraphics = dataItem.get(\"rangeGraphics\")!;\n\t\t\tif (rangeGraphics) {\n\t\t\t\t$array.each(rangeGraphics, (column: any) => {\n\t\t\t\t\tcolumn.set(\"lowX0\", pl0.x - x);\n\t\t\t\t\tcolumn.set(\"lowY0\", pl0.y - y);\n\n\t\t\t\t\tcolumn.set(\"lowX1\", pl1.x - x);\n\t\t\t\t\tcolumn.set(\"lowY1\", pl1.y - y);\n\n\t\t\t\t\tcolumn.set(\"highX0\", ph0.x - x);\n\t\t\t\t\tcolumn.set(\"highY0\", ph0.y - y);\n\n\t\t\t\t\tcolumn.set(\"highX1\", ph1.x - x);\n\t\t\t\t\tcolumn.set(\"highY1\", ph1.y - y);\n\n\t\t\t\t\tcolumn.set(\"orientation\", orientation);\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _processAxisRange(axisRange: this[\"_axisRangeType\"]) {\n\t\tsuper._processAxisRange(axisRange);\n\t\taxisRange.columns = new ListTemplate(\n\t\t\tTemplate.new({}),\n\t\t\t() => Candlestick._new(this._root, {\n\t\t\t\tthemeTags: $utils.mergeTags(axisRange.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"]),\n\t\t\t}, [this.columns.template, axisRange.columns.template])\n\t\t);\n\t}\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}