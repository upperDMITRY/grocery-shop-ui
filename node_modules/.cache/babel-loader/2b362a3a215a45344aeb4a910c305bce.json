{"ast":null,"code":"import { __extends, __read, __spreadArray } from \"tslib\";\nimport * as $type from \"./Type\";\nimport * as $array from \"./Array\";\nimport * as $object from \"./Object\";\nimport { Disposer } from \"./Disposer\";\n/**\r\n * ============================================================================\r\n * DOM FUNCTIONS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Execute a function when DOM is ready.\r\n *\r\n * @since 5.0.2\r\n * @param  f  Callback\r\n */\n\nexport function ready(f) {\n  if (document.readyState !== \"loading\") {\n    f();\n  } else {\n    var listener_1 = function () {\n      if (document.readyState !== \"loading\") {\n        document.removeEventListener(\"readystatechange\", listener_1);\n        f();\n      }\n    };\n\n    document.addEventListener(\"readystatechange\", listener_1);\n  }\n}\n/**\r\n * Removes a DOM element.\r\n * @param  el  Target element\r\n */\n\nexport function removeElement(el) {\n  if (el.parentNode) {\n    el.parentNode.removeChild(el);\n  }\n}\n/**\r\n * Function that adds a disposable event listener directly to a DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param dom       A DOM element to add event to\r\n * @param type      Event type\r\n * @param listener  Event listener\r\n * @returns Disposable event\r\n */\n\nexport function addEventListener(dom, type, listener, options) {\n  //@todo proper type check for options: EventListenerOptions | boolean (TS for some reason gives error on passive parameter)\n  //console.log(type, dom);\n  dom.addEventListener(type, listener, options || false);\n  return new Disposer(function () {\n    dom.removeEventListener(type, listener, options || false);\n  });\n}\n/**\r\n * @ignore\r\n */\n\nexport function supports(cap) {\n  switch (cap) {\n    case \"touchevents\":\n      //return \"ontouchstart\" in document.documentElement;\n      return window.hasOwnProperty(\"TouchEvent\");\n\n    case \"pointerevents\":\n      return window.hasOwnProperty(\"PointerEvent\");\n\n    case \"mouseevents\":\n      return window.hasOwnProperty(\"MouseEvent\");\n\n    case \"wheelevents\":\n      return window.hasOwnProperty(\"WheelEvent\");\n\n    case \"keyboardevents\":\n      return window.hasOwnProperty(\"KeyboardEvent\");\n  }\n\n  return false;\n}\n/**\r\n * @ignore\r\n */\n\nexport function getPointerId(event) {\n  var id = event.pointerId || 0; //console.log(event);\n\n  return id;\n}\n/**\r\n * Removes focus from any element by shifting focus to body.\r\n *\r\n * @ignore\r\n */\n\nexport function blur() {\n  if (document.activeElement && document.activeElement != document.body) {\n    if (document.activeElement.blur) {\n      document.activeElement.blur();\n    } else {\n      var input = document.createElement(\"button\");\n      input.style.position = \"fixed\";\n      input.style.top = \"0px\";\n      input.style.left = \"-10000px\";\n      document.body.appendChild(input);\n      input.focus();\n      input.blur();\n      document.body.removeChild(input);\n    }\n  }\n}\n/**\r\n * Focuses element.\r\n *\r\n * @ignore\r\n */\n\nexport function focus(el) {\n  if (el) {\n    el.focus();\n  }\n}\n/**\r\n * @ignore\r\n */\n\nexport function getRendererEvent(key) {\n  if (supports(\"pointerevents\")) {\n    return key;\n  } else if (supports(\"touchevents\")) {\n    switch (key) {\n      case \"pointerover\":\n        return \"touchstart\";\n\n      case \"pointerout\":\n        return \"touchend\";\n\n      case \"pointerdown\":\n        return \"touchstart\";\n\n      case \"pointermove\":\n        return \"touchmove\";\n\n      case \"pointerup\":\n        return \"touchend\";\n\n      case \"click\":\n        return \"click\";\n\n      case \"dblclick\":\n        return \"dblclick\";\n    }\n  } else if (supports(\"mouseevents\")) {\n    switch (key) {\n      case \"pointerover\":\n        return \"mouseover\";\n\n      case \"pointerout\":\n        return \"mouseout\";\n\n      case \"pointerdown\":\n        return \"mousedown\";\n\n      case \"pointermove\":\n        return \"mousemove\";\n\n      case \"pointerup\":\n        return \"mouseup\";\n\n      case \"click\":\n        return \"click\";\n\n      case \"dblclick\":\n        return \"dblclick\";\n    }\n  }\n\n  return key;\n}\n/**\r\n * Determines if pointer event originated from a touch pointer or mouse.\r\n *\r\n * @param ev  Original event\r\n * @return Touch pointer?\r\n */\n\nexport function isTouchEvent(ev) {\n  if (typeof Touch !== \"undefined\" && ev instanceof Touch) {\n    return true;\n  } else if (typeof PointerEvent !== \"undefined\" && ev instanceof PointerEvent && ev.pointerType != null) {\n    switch (ev.pointerType) {\n      case \"touch\":\n      case \"pen\":\n      case 2:\n        return true;\n\n      case \"mouse\":\n      case 4:\n        return false;\n\n      default:\n        return !(ev instanceof MouseEvent);\n    }\n  } else if (ev.type != null) {\n    if (ev.type.match(/^mouse/)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n/**\r\n * Sets style property on DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n */\n\nexport function setStyle(dom, property, value) {\n  dom.style[property] = value;\n}\nexport function getStyle(dom, property) {\n  return dom.style[property];\n}\n/**\r\n * Checks of element `a` contains element `b`.\r\n *\r\n * @param a  Aleged ascendant\r\n * @param b  Aleged descendant\r\n * @return Contains?\r\n */\n\nexport function contains(a, b) {\n  var cursor = b;\n\n  while (true) {\n    if (a === cursor) {\n      return true;\n    } else if (cursor.parentNode === null) {\n      // TODO better ShadowRoot detection\n      if (cursor.host == null) {\n        return false;\n      } else {\n        cursor = cursor.host;\n      }\n    } else {\n      cursor = cursor.parentNode;\n    }\n  }\n}\n/**\r\n * Disables or enables interactivity of a DOM element.\r\n *\r\n * @param  target       Target element\r\n * @param  interactive  Interactive?\r\n */\n\nexport function setInteractive(target, interactive) {\n  if (interactive) {\n    target.style.pointerEvents = \"\";\n  } else {\n    target.style.pointerEvents = \"none\";\n  }\n}\n/**\r\n * Returns the shadow root of the element or null\r\n *\r\n * @param a  Node\r\n * @return Root\r\n */\n\nexport function getShadowRoot(a) {\n  var cursor = a;\n\n  while (true) {\n    if (cursor.parentNode === null) {\n      // TODO better ShadowRoot detection\n      if (cursor.host != null) {\n        return cursor;\n      } else {\n        return null;\n      }\n    } else {\n      cursor = cursor.parentNode;\n    }\n  }\n}\n/**\r\n * [rootStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n */\n\nvar rootStylesheet;\n/**\r\n * [getStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @return [description]\r\n */\n\nfunction getStylesheet(element, nonce) {\n  if (nonce === void 0) {\n    nonce = \"\";\n  }\n\n  if (element === null) {\n    if (rootStylesheet == null) {\n      // TODO use createElementNS ?\n      var e = document.createElement(\"style\");\n      e.type = \"text/css\";\n\n      if (nonce != \"\") {\n        e.setAttribute(\"nonce\", nonce);\n      }\n\n      document.head.appendChild(e);\n      rootStylesheet = e.sheet;\n    }\n\n    return rootStylesheet;\n  } else {\n    // TODO use createElementNS ?\n    var e = document.createElement(\"style\");\n    e.type = \"text/css\";\n\n    if (nonce != \"\") {\n      e.setAttribute(\"nonce\", nonce);\n    }\n\n    element.appendChild(e);\n    return e.sheet;\n  }\n}\n/**\r\n * [makeStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @param selector  [description]\r\n * @return [description]\r\n */\n\n\nfunction appendStylesheet(root, selector) {\n  var index = root.cssRules.length;\n  root.insertRule(selector + \"{}\", index);\n  return root.cssRules[index];\n}\n/**\r\n * Defines a class for a CSS rule.\r\n *\r\n * Can be used to dynamically add CSS to the document.\r\n */\n\n\nvar StyleRule =\n/** @class */\nfunction (_super) {\n  __extends(StyleRule, _super);\n  /**\r\n   * Constructor.\r\n   *\r\n   * @param selector  CSS selector\r\n   * @param styles    An object of style attribute - value pairs\r\n   */\n\n\n  function StyleRule(element, selector, styles, nonce) {\n    if (nonce === void 0) {\n      nonce = \"\";\n    }\n\n    var _this = this;\n\n    var root = getStylesheet(element, nonce); // TODO test this\n\n    _this = _super.call(this, function () {\n      // TODO a bit hacky\n      var index = $array.indexOf(root.cssRules, _this._rule);\n\n      if (index === -1) {\n        throw new Error(\"Could not dispose StyleRule\");\n      } else {\n        // TODO if it's empty remove it from the DOM ?\n        root.deleteRule(index);\n      }\n    }) || this;\n    /**\r\n     * CSS rule.\r\n     */\n\n    Object.defineProperty(_this, \"_rule\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    _this._rule = appendStylesheet(root, selector);\n    $object.each(styles, function (key, value) {\n      _this.setStyle(key, value);\n    });\n    return _this;\n  }\n\n  Object.defineProperty(StyleRule.prototype, \"selector\", {\n    /**\r\n     * @return CSS selector\r\n     */\n    get: function () {\n      return this._rule.selectorText;\n    },\n\n    /**\r\n     * A CSS selector text.\r\n     *\r\n     * E.g.: `.myClass p`\r\n     *\r\n     * @param selector  CSS selector\r\n     */\n    set: function (selector) {\n      this._rule.selectorText = selector;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Sets the same style properties with browser-specific prefixes.\r\n   *\r\n   * @param name   Attribute name\r\n   * @param value  Attribute value\r\n   */\n\n  Object.defineProperty(StyleRule.prototype, \"_setVendorPrefixName\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (name, value) {\n      var style = this._rule.style;\n      style.setProperty(\"-webkit-\" + name, value, \"\");\n      style.setProperty(\"-moz-\" + name, value, \"\");\n      style.setProperty(\"-ms-\" + name, value, \"\");\n      style.setProperty(\"-o-\" + name, value, \"\");\n      style.setProperty(name, value, \"\");\n    }\n  });\n  /**\r\n   * Sets a value for specific style attribute.\r\n   *\r\n   * @param name   Attribute\r\n   * @param value  Value\r\n   */\n\n  Object.defineProperty(StyleRule.prototype, \"setStyle\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (name, value) {\n      if (name === \"transition\") {\n        this._setVendorPrefixName(name, value);\n      } else {\n        this._rule.style.setProperty(name, value, \"\");\n      }\n    }\n  });\n  return StyleRule;\n}(Disposer);\n\nexport { StyleRule }; // /**\n//  * Applies a set of styles to an element. Stores the original styles so they\n//  * can be restored later.\n//  *\n//  * @ignore\n//  * @param io      Element\n//   */\n// export function prepElementForDrag(dom: HTMLElement): void {\n// \t// @todo: save current values\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"none\");\n// \t\t}\n// \t}\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"rgba(0, 0, 0, 0)\");\n// }\n// /**\n//  * Restores replaced styles\n//  *\n//  * @ignore\n//  * @param  io  Element\n//  */\n// export function unprepElementForDrag(dom: HTMLElement): void {\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"\");\n// \t\t}\n// \t}\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"\");\n// }\n\nexport function relativeToValue(percent, full) {\n  if ($type.isNumber(percent)) {\n    return percent;\n  } else if (percent != null && $type.isNumber(percent.value) && $type.isNumber(full)) {\n    return full * percent.value;\n  } else {\n    return 0;\n  }\n}\n/**\r\n * Returns number of decimals\r\n *\r\n * @ignore Exclude from docs\r\n * @param number  Input number\r\n * @return Number of decimals\r\n */\n\nexport function decimalPlaces(number) {\n  var match = ('' + number).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\n\n  if (!match) {\n    return 0;\n  }\n\n  return Math.max(0, (match[1] ? match[1].length : 0) - (match[2] ? +match[2] : 0));\n}\n/**\r\n * ============================================================================\r\n * STRING FORMATTING FUNCTIONS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Pads a string with additional characters to certain length.\r\n *\r\n * @param value  A numeric value\r\n * @param len    Result string length in characters\r\n * @param char   A character to use for padding\r\n * @return Padded value as string\r\n */\n\nexport function padString(value, len, char) {\n  if (len === void 0) {\n    len = 0;\n  }\n\n  if (char === void 0) {\n    char = \"0\";\n  }\n\n  if (typeof value !== \"string\") {\n    value = value.toString();\n  }\n\n  return len > value.length ? Array(len - value.length + 1).join(char) + value : value;\n}\nexport function trimLeft(text) {\n  return text.replace(/^[\\n \\t]+/, \"\");\n}\nexport function trimRight(text) {\n  return text.replace(/^[\\n \\t]+$/, \"\");\n}\nexport function trim(text) {\n  return trimLeft(trimRight(text));\n}\n/**\r\n * Tries to determine format type.\r\n *\r\n * @ignore Exclude from docs\r\n * @param format  Format string\r\n * @return Format type (\"string\" | \"number\" | \"date\" | \"duration\")\r\n */\n\nexport function getFormat(format) {\n  // Undefined?\n  if (typeof format === \"undefined\") {\n    return \"string\";\n  } // Cleanup and lowercase format\n\n\n  format = format.toLowerCase().replace(/^\\[[^\\]]*\\]/, \"\"); // Remove style tags\n\n  format = format.replace(/\\[[^\\]]+\\]/, \"\"); // Trim\n\n  format = format.trim(); // Check for any explicit format hints (i.e. /Date)\n\n  var hints = format.match(/\\/(date|number|duration)$/);\n\n  if (hints) {\n    return hints[1];\n  } // Check for explicit hints\n\n\n  if (format === \"number\") {\n    return \"number\";\n  }\n\n  if (format === \"date\") {\n    return \"date\";\n  }\n\n  if (format === \"duration\") {\n    return \"duration\";\n  } // Detect number formatting symbols\n\n\n  if (format.match(/[#0]/)) {\n    return \"number\";\n  } // Detect date formatting symbols\n\n\n  if (format.match(/[ymwdhnsqaxkzgtei]/)) {\n    return \"date\";\n  } // Nothing? Let's display as string\n\n\n  return \"string\";\n}\n/**\r\n * Cleans up format:\r\n * * Strips out formatter hints\r\n *\r\n * @ignore Exclude from docs\r\n * @param format  Format\r\n * @return Cleaned format\r\n */\n\nexport function cleanFormat(format) {\n  return format.replace(/\\/(date|number|duration)$/i, \"\");\n}\n/**\r\n * Strips all tags from the string.\r\n *\r\n * @param text  Source string\r\n * @return String without tags\r\n */\n\nexport function stripTags(text) {\n  return text ? text.replace(/<[^>]*>/g, \"\") : text;\n}\n/**\r\n * Removes new lines and tags from a string.\r\n *\r\n * @param text  String to conver\r\n * @return Converted string\r\n */\n\nexport function plainText(text) {\n  return text ? stripTags((\"\" + text).replace(/[\\n\\r]+/g, \". \")) : text;\n}\n/**\r\n * Escapes string so it can safely be used in a Regex.\r\n *\r\n * @param value  Unsescaped string\r\n * @return Escaped string\r\n */\n\nexport function escapeForRgex(value) {\n  return value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n}\n/**\r\n * ============================================================================\r\n * DATE-RELATED FUNCTIONS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Returns a year day.\r\n *\r\n * @param date  Date\r\n * @param utc   Assume UTC dates?\r\n * @return Year day\r\n * @todo Account for UTC\r\n */\n\nexport function getYearDay(date, utc) {\n  if (utc === void 0) {\n    utc = false;\n  } // TODO: utc needed?\n\n\n  utc;\n  var start = new Date(date.getFullYear(), 0, 0);\n  var diff = date.getTime() - start.getTime() + (start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000;\n  var oneDay = 1000 * 60 * 60 * 24;\n  return Math.floor(diff / oneDay);\n}\n/**\r\n * Returns week number for a given date.\r\n *\r\n * @param date  Date\r\n * @param utc   Assume UTC dates?\r\n * @return Week number\r\n * @todo Account for UTC\r\n */\n\nexport function getWeek(date, utc) {\n  if (utc === void 0) {\n    utc = false;\n  }\n\n  var day = getYearDay(date, utc) - 1;\n  var week = Math.floor((day - (date.getDay() || 7) + 10) / 7);\n\n  if (week === 0) {\n    week = 53;\n  } else if (week === 53) {\n    week = 1;\n  }\n\n  return week;\n}\n/**\r\n * Returns a week number in the month.\r\n *\r\n * @param date  Source Date\r\n * @param utc   Assume UTC dates?\r\n * @return Week number in month\r\n */\n\nexport function getMonthWeek(date, utc) {\n  if (utc === void 0) {\n    utc = false;\n  }\n\n  var firstWeek = getWeek(new Date(date.getFullYear(), date.getMonth(), 1), utc);\n  var currentWeek = getWeek(date, utc);\n\n  if (currentWeek == 1) {\n    currentWeek = 53;\n  }\n\n  return currentWeek - firstWeek + 1;\n}\n/**\r\n * Returns a year day out of the given week number.\r\n *\r\n * @param week     Week\r\n * @param year     Year\r\n * @param weekday  Weekday\r\n * @param utc      Assume UTC dates\r\n * @return Day in a year\r\n */\n\nexport function getDayFromWeek(week, year, weekday, utc) {\n  if (weekday === void 0) {\n    weekday = 1;\n  }\n\n  if (utc === void 0) {\n    utc = false;\n  }\n\n  var date = new Date(year, 0, 4, 0, 0, 0, 0);\n\n  if (utc) {\n    date.setUTCFullYear(year);\n  }\n\n  var day = week * 7 + weekday - ((date.getDay() || 7) + 3);\n  return day;\n}\n/**\r\n * Returns 12-hour representation out of the 24-hour hours.\r\n *\r\n * @param hours  24-hour number\r\n * @return 12-hour number\r\n */\n\nexport function get12Hours(hours, base) {\n  if (hours > 12) {\n    hours -= 12;\n  } else if (hours === 0) {\n    hours = 12;\n  }\n\n  return base != null ? hours + (base - 1) : hours;\n}\n/**\r\n * Returns a string name of the tome zone.\r\n *\r\n * @param date     Date object\r\n * @param long     Should return long (\"Pacific Standard Time\") or short abbreviation (\"PST\")\r\n * @param savings  Include information if it's in daylight savings mode\r\n * @param utc      Assume UTC dates\r\n * @return Time zone name\r\n */\n\nexport function getTimeZone(date, long, savings, utc) {\n  if (long === void 0) {\n    long = false;\n  }\n\n  if (savings === void 0) {\n    savings = false;\n  }\n\n  if (utc === void 0) {\n    utc = false;\n  }\n\n  if (utc) {\n    return long ? \"Coordinated Universal Time\" : \"UTC\";\n  }\n\n  var wotz = date.toLocaleString(\"UTC\");\n  var wtz = date.toLocaleString(\"UTC\", {\n    timeZoneName: long ? \"long\" : \"short\"\n  }).substr(wotz.length); //wtz = wtz.replace(/[+-]+[0-9]+$/, \"\");\n\n  if (savings === false) {\n    wtz = wtz.replace(/ (standard|daylight|summer|winter) /i, \" \");\n  }\n\n  return wtz;\n}\nexport function capitalizeFirst(text) {\n  return text.charAt(0).toUpperCase() + text.slice(1);\n}\n/**\r\n * The functions below are taken and adapted from Garry Tan's blog post:\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n *\r\n * The further attributions go mjijackson.com, which now seems to be defunct.\r\n */\n\n/**\r\n * Converts an HSL color value to RGB. Conversion formula\r\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n * Assumes h, s, and l are contained in the set [0, 1] and\r\n * returns r, g, and b in the set [0, 255].\r\n *\r\n * Function adapted from:\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n *\r\n * @ignore Exclude from docs\r\n * @param h       The hue\r\n * @param s       The saturation\r\n * @param l       The lightness\r\n * @return The RGB representation\r\n */\n\nexport function hslToRgb(color) {\n  var r, g, b;\n  var h = color.h;\n  var s = color.s;\n  var l = color.l;\n\n  if (s == 0) {\n    r = g = b = l; // achromatic\n  } else {\n    var hue2rgb = function hue2rgb(p, q, t) {\n      if (t < 0) {\n        t += 1;\n      }\n\n      if (t > 1) {\n        t -= 1;\n      }\n\n      if (t < 1 / 6) {\n        return p + (q - p) * 6 * t;\n      }\n\n      if (t < 1 / 2) {\n        return q;\n      }\n\n      if (t < 2 / 3) {\n        return p + (q - p) * (2 / 3 - t) * 6;\n      }\n\n      return p;\n    };\n\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255)\n  };\n}\n/**\r\n * Converts an RGB color value to HSL. Conversion formula\r\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n * Assumes r, g, and b are contained in the set [0, 255] and\r\n * returns h, s, and l in the set [0, 1].\r\n *\r\n * Function adapted from:\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n *\r\n * @ignore Exclude from docs\r\n * @param r       The red color value\r\n * @param g       The green color value\r\n * @param b       The blue color value\r\n * @return The HSL representation\r\n */\n\nexport function rgbToHsl(color) {\n  var r = color.r / 255;\n  var g = color.g / 255;\n  var b = color.b / 255;\n  var max = Math.max(r, g, b);\n  var min = Math.min(r, g, b);\n  var h = 0;\n  var s = 0;\n  var l = (max + min) / 2;\n\n  if (max === min) {\n    h = s = 0; // achromatic\n  } else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n\n      case g:\n        h = (b - r) / d + 2;\n        break;\n\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n\n    h /= 6;\n  }\n\n  return {\n    h: h,\n    s: s,\n    l: l\n  };\n}\n/**\r\n * Returns a color that is `percent` brighter than the reference color.\r\n *\r\n * @ignore Exclude from docs\r\n * @param color    Reference color\r\n * @param percent  Brightness percent\r\n * @return Hex code of the new color\r\n */\n\nexport function lighten(rgb, percent) {\n  if (rgb) {\n    return {\n      r: Math.max(0, Math.min(255, rgb.r + getLightnessStep(rgb.r, percent))),\n      g: Math.max(0, Math.min(255, rgb.g + getLightnessStep(rgb.g, percent))),\n      b: Math.max(0, Math.min(255, rgb.b + getLightnessStep(rgb.b, percent))),\n      a: rgb.a\n    };\n  } else {\n    // TODO is this correct ?\n    return rgb;\n  }\n}\n;\n/**\r\n * Gets lightness step.\r\n *\r\n * @ignore Exclude from docs\r\n * @param value    Value\r\n * @param percent  Percent\r\n * @return Step\r\n */\n\nexport function getLightnessStep(value, percent) {\n  var base = percent > 0 ? 255 - value : value;\n  return Math.round(base * percent);\n}\n/**\r\n * Returns a color that is `percent` brighter than the source `color`.\r\n *\r\n * @ignore Exclude from docs\r\n * @param color    Source color\r\n * @param percent  Brightness percent\r\n * @return New color\r\n */\n\nexport function brighten(rgb, percent) {\n  if (rgb) {\n    var base = Math.min(Math.max(rgb.r, rgb.g, rgb.b), 230); //let base = Math.max(rgb.r, rgb.g, rgb.b);\n\n    var step = getLightnessStep(base, percent);\n    return {\n      r: Math.max(0, Math.min(255, Math.round(rgb.r + step))),\n      g: Math.max(0, Math.min(255, Math.round(rgb.g + step))),\n      b: Math.max(0, Math.min(255, Math.round(rgb.b + step))),\n      a: rgb.a\n    };\n  } else {\n    // TODO is this correct ?\n    return rgb;\n  }\n}\n;\n/**\r\n * Returns brightness step.\r\n *\r\n * @ignore Exclude from docs\r\n * @param value    Value\r\n * @param percent  Percent\r\n * @return Step\r\n */\n\nexport function getBrightnessStep(_value, percent) {\n  var base = 255; //percent > 0 ? 255 - value : value;\n\n  return Math.round(base * percent);\n}\n/**\r\n * Returns `true` if color is \"light\". Useful indetermining which contrasting\r\n * color to use for elements over this color. E.g.: you would want to use\r\n * black text over light background, and vice versa.\r\n *\r\n * @ignore Exclude from docs\r\n * @param color  Source color\r\n * @return Light?\r\n */\n\nexport function isLight(color) {\n  return (color.r * 299 + color.g * 587 + color.b * 114) / 1000 >= 128;\n}\n/**\r\n * Returns a new [[iRGB]] object based on `rgb` parameter with specific\r\n * saturation applied.\r\n *\r\n * `saturation` can be in the range of 0 (fully desaturated) to 1 (fully\r\n * saturated).\r\n *\r\n * @ignore Exclude from docs\r\n * @param color       Base color\r\n * @param saturation  Saturation (0-1)\r\n * @return New color\r\n */\n\nexport function saturate(rgb, saturation) {\n  if (rgb === undefined || saturation == 1) {\n    return rgb;\n  }\n\n  var hsl = rgbToHsl(rgb);\n  hsl.s = saturation;\n  return hslToRgb(hsl);\n}\nexport function alternativeColor(color, lightAlternative, darkAlternative) {\n  if (lightAlternative === void 0) {\n    lightAlternative = {\n      r: 255,\n      g: 255,\n      b: 255\n    };\n  }\n\n  if (darkAlternative === void 0) {\n    darkAlternative = {\n      r: 255,\n      g: 255,\n      b: 255\n    };\n  }\n\n  var light = lightAlternative;\n  var dark = darkAlternative;\n\n  if (isLight(darkAlternative)) {\n    light = darkAlternative;\n    dark = lightAlternative;\n  }\n\n  return isLight(color) ? dark : light;\n}\n/**\r\n * @ignore\r\n * @deprecated\r\n */\n// export function unshiftThemeClass(settings: any, themeClass: string) {\n// \tlet themeClasses = settings.themeClasses;\n// \tif (!themeClasses) {\n// \t\tthemeClasses = [];\n// \t}\n// \tthemeClasses.unshift(themeClass);\n// \tsettings.themeClasses = themeClasses;\n// }\n\n/**\r\n * @ignore\r\n * @deprecated\r\n */\n// export function pushThemeClass(settings: any, themeClass: string) {\n// \tlet themeClasses = settings.themeClasses;\n// \tif (!themeClasses) {\n// \t\tthemeClasses = [];\n// \t}\n// \tthemeClasses.push(themeClass);\n// \tsettings.themeClasses = themeClasses;\n// }\n\n/**\r\n * @ignore\r\n */\n\nexport function mergeTags(tags1, tags2) {\n  if (!tags1) {\n    tags1 = [];\n  }\n\n  return __spreadArray(__spreadArray([], __read(tags1)), __read(tags2)).filter(function (value, index, self) {\n    return self.indexOf(value) === index;\n  });\n}\n/**\r\n * @ignore\r\n */\n\nexport function sameBounds(a, b) {\n  if (!b) {\n    return false;\n  }\n\n  if (a.left != b.left) {\n    return false;\n  }\n\n  if (a.right != b.right) {\n    return false;\n  }\n\n  if (a.top != b.top) {\n    return false;\n  }\n\n  if (a.bottom != b.bottom) {\n    return false;\n  }\n\n  return true;\n}","map":{"version":3,"sources":["../../../../../src/.internal/core/util/Utils.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Percent } from \"./Percent\";\nimport type { IPointerEvent } from \"../render/backend/Renderer\";\n\nimport * as $type from \"./Type\";\nimport * as $array from \"./Array\";\nimport * as $object from \"./Object\";\nimport type { IBounds } from \"./IBounds\";\n\nimport { Disposer, IDisposer } from \"./Disposer\";\n\n/**\n * ============================================================================\n * DOM FUNCTIONS\n * ============================================================================\n * @hidden\n */\n\n/**\n * Execute a function when DOM is ready.\n * \n * @since 5.0.2\n * @param  f  Callback\n */\nexport function ready(f: () => void): void {\n\tif (document.readyState !== \"loading\") {\n\t\tf();\n\n\t} else {\n\t\tconst listener = () => {\n\t\t\tif (document.readyState !== \"loading\") {\n\t\t\t\tdocument.removeEventListener(\"readystatechange\", listener);\n\t\t\t\tf();\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener(\"readystatechange\", listener);\n\t}\n}\n\n/**\n * Removes a DOM element.\n * @param  el  Target element\n */\nexport function removeElement(el: HTMLElement): void {\n\tif (el.parentNode) {\n\t\tel.parentNode.removeChild(el);\n\t}\n}\n\n/**\n * Function that adds a disposable event listener directly to a DOM element.\n *\n * @ignore Exclude from docs\n * @param dom       A DOM element to add event to\n * @param type      Event type\n * @param listener  Event listener\n * @returns Disposable event\n */\nexport function addEventListener<E extends Event>(dom: EventTarget, type: string, listener: (event: E) => void, options?: any): IDisposer {\n\t//@todo proper type check for options: EventListenerOptions | boolean (TS for some reason gives error on passive parameter)\n\t//console.log(type, dom);\n\tdom.addEventListener(type, <EventListener>listener, options || false);\n\n\treturn new Disposer(() => {\n\t\tdom.removeEventListener(type, <EventListener>listener, options || false);\n\t});\n}\n\n/**\n * @ignore\n */\nexport function supports(cap: \"touchevents\" | \"pointerevents\" | \"mouseevents\" | \"wheelevents\" | \"keyboardevents\"): boolean {\n\tswitch (cap) {\n\t\tcase \"touchevents\":\n\t\t\t//return \"ontouchstart\" in document.documentElement;\n\t\t\treturn window.hasOwnProperty(\"TouchEvent\");\n\n\t\tcase \"pointerevents\":\n\t\t\treturn window.hasOwnProperty(\"PointerEvent\");\n\n\t\tcase \"mouseevents\":\n\t\t\treturn window.hasOwnProperty(\"MouseEvent\");\n\n\t\tcase \"wheelevents\":\n\t\t\treturn window.hasOwnProperty(\"WheelEvent\");\n\n\t\tcase \"keyboardevents\":\n\t\t\treturn window.hasOwnProperty(\"KeyboardEvent\");\n\t}\n\treturn false;\n}\n\n/**\n * @ignore\n */\nexport function getPointerId(event: IPointerEvent) {\n\tlet id = (<any>event).pointerId || 0;\n\t//console.log(event);\n\treturn id;\n}\n\n/**\n * Removes focus from any element by shifting focus to body.\n *\n * @ignore\n */\nexport function blur(): void {\n\tif (document.activeElement && document.activeElement != document.body) {\n\t\tif ((<any>document.activeElement).blur) {\n\t\t\t(<any>document.activeElement).blur();\n\t\t}\n\t\telse {\n\t\t\tlet input = document.createElement(\"button\");\n\t\t\tinput.style.position = \"fixed\";\n\t\t\tinput.style.top = \"0px\";\n\t\t\tinput.style.left = \"-10000px\";\n\t\t\tdocument.body.appendChild(input);\n\t\t\tinput.focus();\n\t\t\tinput.blur();\n\t\t\tdocument.body.removeChild(input);\n\t\t}\n\t}\n}\n\n/**\n * Focuses element.\n * \n * @ignore\n */\nexport function focus(el: HTMLElement): void {\n\tif (el) {\n\t\tel.focus();\n\t}\n}\n\n/**\n * @ignore\n */\nexport function getRendererEvent(key: string): string {\n\tif (supports(\"pointerevents\")) {\n\t\treturn key;\n\t}\n\telse if (supports(\"touchevents\")) {\n\t\tswitch (key) {\n\t\t\tcase \"pointerover\": return \"touchstart\";\n\t\t\tcase \"pointerout\": return \"touchend\";\n\t\t\tcase \"pointerdown\": return \"touchstart\";\n\t\t\tcase \"pointermove\": return \"touchmove\";\n\t\t\tcase \"pointerup\": return \"touchend\";\n\t\t\tcase \"click\": return \"click\";\n\t\t\tcase \"dblclick\": return \"dblclick\";\n\n\t\t}\n\t}\n\telse if (supports(\"mouseevents\")) {\n\t\tswitch (key) {\n\t\t\tcase \"pointerover\": return \"mouseover\";\n\t\t\tcase \"pointerout\": return \"mouseout\";\n\t\t\tcase \"pointerdown\": return \"mousedown\";\n\t\t\tcase \"pointermove\": return \"mousemove\";\n\t\t\tcase \"pointerup\": return \"mouseup\";\n\t\t\tcase \"click\": return \"click\";\n\t\t\tcase \"dblclick\": return \"dblclick\";\n\n\t\t}\n\t}\n\treturn key;\n}\n\n/**\n * Determines if pointer event originated from a touch pointer or mouse.\n *\n * @param ev  Original event\n * @return Touch pointer?\n */\nexport function isTouchEvent(ev: MouseEvent | Touch): boolean {\n\tif (typeof Touch !== \"undefined\" && ev instanceof Touch) {\n\t\treturn true;\n\t}\n\telse if (typeof PointerEvent !== \"undefined\" && ev instanceof PointerEvent && (<any>ev).pointerType != null) {\n\t\tswitch ((<any>ev).pointerType) {\n\t\t\tcase \"touch\":\n\t\t\tcase \"pen\":\n\t\t\tcase 2:\n\t\t\t\treturn true;\n\t\t\tcase \"mouse\":\n\t\t\tcase 4:\n\t\t\t\treturn false;\n\t\t\tdefault:\n\t\t\t\treturn !(ev instanceof MouseEvent);\n\t\t}\n\t}\n\telse if ((<any>ev).type != null) {\n\t\tif ((<any>ev).type.match(/^mouse/)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * Sets style property on DOM element.\n *\n * @ignore Exclude from docs\n */\nexport function setStyle(dom: HTMLElement, property: string, value: string | undefined): void {\n\t(<any>dom.style)[property] = value;\n}\n\nexport function getStyle(dom: HTMLElement, property: string): string | undefined {\n\treturn (<any>dom.style)[property];\n}\n\n/**\n * Checks of element `a` contains element `b`.\n *\n * @param a  Aleged ascendant\n * @param b  Aleged descendant\n * @return Contains?\n */\nexport function contains(a: Element, b: Element): boolean {\n\tlet cursor: Node = b;\n\n\twhile (true) {\n\t\tif (a === cursor) {\n\t\t\treturn true;\n\n\t\t} else if (cursor.parentNode === null) {\n\t\t\t// TODO better ShadowRoot detection\n\t\t\tif ((<ShadowRoot>cursor).host == null) {\n\t\t\t\treturn false;\n\n\t\t\t} else {\n\t\t\t\tcursor = (<ShadowRoot>cursor).host;\n\t\t\t}\n\n\t\t} else {\n\t\t\tcursor = cursor.parentNode;\n\t\t}\n\t}\n}\n\n/**\n * Disables or enables interactivity of a DOM element.\n * \n * @param  target       Target element\n * @param  interactive  Interactive?\n */\nexport function setInteractive(target: HTMLElement, interactive: boolean): void {\n\tif (interactive) {\n\t\ttarget.style.pointerEvents = \"\";\n\t}\n\telse {\n\t\ttarget.style.pointerEvents = \"none\";\n\t}\n}\n\n/**\n * Returns the shadow root of the element or null\n *\n * @param a  Node\n * @return Root\n */\nexport function getShadowRoot(a: Node): ShadowRoot | null {\n\tlet cursor: Node = a;\n\n\twhile (true) {\n\t\tif (cursor.parentNode === null) {\n\t\t\t// TODO better ShadowRoot detection\n\t\t\tif ((<ShadowRoot>cursor).host != null) {\n\t\t\t\treturn <ShadowRoot>cursor;\n\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t} else {\n\t\t\tcursor = cursor.parentNode;\n\t\t}\n\t}\n}\n\n/**\n * [rootStylesheet description]\n *\n * @ignore Exclude from docs\n * @todo Description\n */\nlet rootStylesheet: $type.Optional<CSSStyleSheet>;\n\n/**\n * [getStylesheet description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @return [description]\n */\nfunction getStylesheet(element: ShadowRoot | null, nonce: string = \"\"): CSSStyleSheet {\n\tif (element === null) {\n\t\tif (rootStylesheet == null) {\n\t\t\t// TODO use createElementNS ?\n\t\t\tconst e = document.createElement(\"style\");\n\t\t\te.type = \"text/css\";\n\t\t\tif (nonce != \"\") {\n\t\t\t\te.setAttribute(\"nonce\", nonce)\n\t\t\t}\n\t\t\tdocument.head.appendChild(e);\n\t\t\trootStylesheet = e.sheet as CSSStyleSheet;\n\t\t}\n\n\t\treturn rootStylesheet;\n\n\t} else {\n\t\t// TODO use createElementNS ?\n\t\tconst e = document.createElement(\"style\");\n\t\te.type = \"text/css\";\n\t\tif (nonce != \"\") {\n\t\t\te.setAttribute(\"nonce\", nonce)\n\t\t}\n\t\telement.appendChild(e);\n\t\treturn e.sheet as CSSStyleSheet;\n\t}\n}\n\n/**\n * [makeStylesheet description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @param selector  [description]\n * @return [description]\n */\nfunction appendStylesheet(root: CSSStyleSheet, selector: string): CSSStyleRule {\n\tconst index = root.cssRules.length;\n\n\troot.insertRule(selector + \"{}\", index);\n\n\treturn root.cssRules[index] as CSSStyleRule;\n}\n\n/**\n * Defines a class for a CSS rule.\n *\n * Can be used to dynamically add CSS to the document.\n */\nexport class StyleRule extends Disposer {\n\n\t/**\n\t * CSS rule.\n\t */\n\tprivate _rule: CSSStyleRule;\n\n\t/**\n\t * A CSS selector text.\n\t *\n\t * E.g.: `.myClass p`\n\t *\n\t * @param selector  CSS selector\n\t */\n\tpublic set selector(selector: string) {\n\t\tthis._rule.selectorText = selector;\n\t}\n\n\t/**\n\t * @return CSS selector\n\t */\n\tpublic get selector(): string {\n\t\treturn this._rule.selectorText;\n\t}\n\n\t/**\n\t * Constructor.\n\t *\n\t * @param selector  CSS selector\n\t * @param styles    An object of style attribute - value pairs\n\t */\n\tconstructor(element: ShadowRoot | null, selector: string, styles: { [name: string]: string }, nonce: string = \"\") {\n\t\tconst root = getStylesheet(element, nonce);\n\n\t\t// TODO test this\n\t\tsuper(() => {\n\t\t\t// TODO a bit hacky\n\t\t\tconst index = $array.indexOf(root.cssRules, this._rule);\n\n\t\t\tif (index === -1) {\n\t\t\t\tthrow new Error(\"Could not dispose StyleRule\");\n\n\t\t\t} else {\n\t\t\t\t// TODO if it's empty remove it from the DOM ?\n\t\t\t\troot.deleteRule(index);\n\t\t\t}\n\t\t});\n\n\t\tthis._rule = appendStylesheet(root, selector);\n\n\t\t$object.each(styles, (key, value) => {\n\t\t\tthis.setStyle(<string>key, value);\n\t\t});\n\t}\n\n\t/**\n\t * Sets the same style properties with browser-specific prefixes.\n\t *\n\t * @param name   Attribute name\n\t * @param value  Attribute value\n\t */\n\tprivate _setVendorPrefixName(name: string, value: string): void {\n\t\tconst style = this._rule.style;\n\t\tstyle.setProperty(\"-webkit-\" + name, value, \"\");\n\t\tstyle.setProperty(\"-moz-\" + name, value, \"\");\n\t\tstyle.setProperty(\"-ms-\" + name, value, \"\");\n\t\tstyle.setProperty(\"-o-\" + name, value, \"\");\n\t\tstyle.setProperty(name, value, \"\");\n\t}\n\n\t/**\n\t * Sets a value for specific style attribute.\n\t *\n\t * @param name   Attribute\n\t * @param value  Value\n\t */\n\tpublic setStyle(name: string, value: string): void {\n\t\tif (name === \"transition\") {\n\t\t\tthis._setVendorPrefixName(name, value);\n\n\t\t} else {\n\t\t\tthis._rule.style.setProperty(name, value, \"\");\n\t\t}\n\t}\n\n}\n\n// /**\n//  * Applies a set of styles to an element. Stores the original styles so they\n//  * can be restored later.\n//  *\n//  * @ignore\n//  * @param io      Element\n//   */\n// export function prepElementForDrag(dom: HTMLElement): void {\n\n// \t// @todo: save current values\n\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"none\");\n// \t\t}\n// \t}\n\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"rgba(0, 0, 0, 0)\");\n\n// }\n\n// /**\n//  * Restores replaced styles\n//  *\n//  * @ignore\n//  * @param  io  Element\n//  */\n// export function unprepElementForDrag(dom: HTMLElement): void {\n\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"\");\n// \t\t}\n// \t}\n\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"\");\n\n// }\n\n\n\nexport function relativeToValue(percent: number | Percent | undefined | null, full: number): number {\n\tif ($type.isNumber(percent)) {\n\t\treturn percent;\n\t} else if (percent != null && $type.isNumber(percent.value) && $type.isNumber(full)) {\n\t\treturn full * percent.value;\n\n\t} else {\n\t\treturn 0;\n\t}\n}\n\n\n\n/**\n * Returns number of decimals\n *\n * @ignore Exclude from docs\n * @param number  Input number\n * @return Number of decimals\n */\nexport function decimalPlaces(number: number): number {\n\tlet match = ('' + number).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\n\tif (!match) { return 0; }\n\treturn Math.max(0, (match[1] ? match[1].length : 0) - (match[2] ? +match[2] : 0));\n}\n\n\n/**\n * ============================================================================\n * STRING FORMATTING FUNCTIONS\n * ============================================================================\n * @hidden\n */\n\n/**\n * Pads a string with additional characters to certain length.\n *\n * @param value  A numeric value\n * @param len    Result string length in characters\n * @param char   A character to use for padding\n * @return Padded value as string\n */\nexport function padString(value: any, len: number = 0, char: string = \"0\"): string {\n\tif (typeof value !== \"string\") {\n\t\tvalue = value.toString();\n\t}\n\n\treturn len > value.length ? Array(len - value.length + 1).join(char) + value : value;\n}\n\nexport function trimLeft(text: string): string {\n\treturn text.replace(/^[\\n \\t]+/, \"\");\n}\n\nexport function trimRight(text: string): string {\n\treturn text.replace(/^[\\n \\t]+$/, \"\");\n}\n\nexport function trim(text: string): string {\n\treturn trimLeft(trimRight(text));\n}\n\n/**\n * Tries to determine format type.\n *\n * @ignore Exclude from docs\n * @param format  Format string\n * @return Format type (\"string\" | \"number\" | \"date\" | \"duration\")\n */\nexport function getFormat(format: string): string {\n\n\t// Undefined?\n\tif (typeof format === \"undefined\") {\n\t\treturn \"string\";\n\t}\n\n\t// Cleanup and lowercase format\n\tformat = format.toLowerCase().replace(/^\\[[^\\]]*\\]/, \"\");\n\n\t// Remove style tags\n\tformat = format.replace(/\\[[^\\]]+\\]/, \"\");\n\n\t// Trim\n\tformat = format.trim();\n\n\t// Check for any explicit format hints (i.e. /Date)\n\tlet hints: RegExpMatchArray | null = format.match(/\\/(date|number|duration)$/);\n\n\tif (hints) {\n\t\treturn hints[1];\n\t}\n\n\t// Check for explicit hints\n\tif (format === \"number\") {\n\t\treturn \"number\";\n\t}\n\n\tif (format === \"date\") {\n\t\treturn \"date\";\n\t}\n\n\tif (format === \"duration\") {\n\t\treturn \"duration\";\n\t}\n\n\t// Detect number formatting symbols\n\tif (format.match(/[#0]/)) {\n\t\treturn \"number\";\n\t}\n\n\t// Detect date formatting symbols\n\tif (format.match(/[ymwdhnsqaxkzgtei]/)) {\n\t\treturn \"date\";\n\t}\n\n\t// Nothing? Let's display as string\n\treturn \"string\";\n}\n\n/**\n * Cleans up format:\n * * Strips out formatter hints\n *\n * @ignore Exclude from docs\n * @param format  Format\n * @return Cleaned format\n */\nexport function cleanFormat(format: string): string {\n\treturn format.replace(/\\/(date|number|duration)$/i, \"\");\n}\n\n/**\n * Strips all tags from the string.\n *\n * @param text  Source string\n * @return String without tags\n */\nexport function stripTags(text: string): string {\n\treturn text ? text.replace(/<[^>]*>/g, \"\") : text;\n}\n\n/**\n * Removes new lines and tags from a string.\n *\n * @param text  String to conver\n * @return Converted string\n */\nexport function plainText(text: string): string {\n\treturn text ? stripTags((\"\" + text).replace(/[\\n\\r]+/g, \". \")) : text;\n}\n\n/**\n * Escapes string so it can safely be used in a Regex.\n *\n * @param value  Unsescaped string\n * @return Escaped string\n */\nexport function escapeForRgex(value: string): string {\n\treturn value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n}\n\n/**\n * ============================================================================\n * DATE-RELATED FUNCTIONS\n * ============================================================================\n * @hidden\n */\n\n/**\n * Returns a year day.\n *\n * @param date  Date\n * @param utc   Assume UTC dates?\n * @return Year day\n * @todo Account for UTC\n */\nexport function getYearDay(date: Date, utc: boolean = false): number {\n\t// TODO: utc needed?\n\tutc;\n\tconst start = new Date(date.getFullYear(), 0, 0);\n\tconst diff = (date.getTime() - start.getTime()) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000);\n\tconst oneDay = 1000 * 60 * 60 * 24;\n\treturn Math.floor(diff / oneDay);\n}\n\n/**\n * Returns week number for a given date.\n *\n * @param date  Date\n * @param utc   Assume UTC dates?\n * @return Week number\n * @todo Account for UTC\n */\nexport function getWeek(date: Date, utc: boolean = false): number {\n\tconst day = getYearDay(date, utc) - 1;\n\tlet week = Math.floor((day - (date.getDay() || 7) + 10) / 7);\n\tif (week === 0) {\n\t\tweek = 53;\n\t}\n\telse if (week === 53) {\n\t\tweek = 1;\n\t}\n\treturn week;\n}\n\n/**\n * Returns a week number in the month.\n *\n * @param date  Source Date\n * @param utc   Assume UTC dates?\n * @return Week number in month\n */\nexport function getMonthWeek(date: Date, utc: boolean = false): number {\n\tconst firstWeek = getWeek(new Date(date.getFullYear(), date.getMonth(), 1), utc);\n\tlet currentWeek = getWeek(date, utc);\n\tif (currentWeek == 1) {\n\t\tcurrentWeek = 53;\n\t}\n\treturn currentWeek - firstWeek + 1;\n}\n\n/**\n * Returns a year day out of the given week number.\n *\n * @param week     Week\n * @param year     Year\n * @param weekday  Weekday\n * @param utc      Assume UTC dates\n * @return Day in a year\n */\nexport function getDayFromWeek(week: number, year: number, weekday: number = 1, utc: boolean = false): number {\n\tlet date = new Date(year, 0, 4, 0, 0, 0, 0);\n\tif (utc) {\n\t\tdate.setUTCFullYear(year);\n\t}\n\tlet day = week * 7 + weekday - ((date.getDay() || 7) + 3);\n\treturn day;\n}\n\n/**\n * Returns 12-hour representation out of the 24-hour hours.\n *\n * @param hours  24-hour number\n * @return 12-hour number\n */\nexport function get12Hours(hours: number, base?: number): number {\n\tif (hours > 12) {\n\t\thours -= 12;\n\t}\n\telse if (hours === 0) {\n\t\thours = 12;\n\t}\n\treturn base != null ? hours + (base - 1) : hours;\n}\n\n/**\n * Returns a string name of the tome zone.\n *\n * @param date     Date object\n * @param long     Should return long (\"Pacific Standard Time\") or short abbreviation (\"PST\")\n * @param savings  Include information if it's in daylight savings mode\n * @param utc      Assume UTC dates\n * @return Time zone name\n */\nexport function getTimeZone(date: Date, long: boolean = false, savings: boolean = false, utc: boolean = false): string {\n\tif (utc) {\n\t\treturn long ? \"Coordinated Universal Time\" : \"UTC\";\n\t}\n\tlet wotz = date.toLocaleString(\"UTC\");\n\tlet wtz = date.toLocaleString(\"UTC\", { timeZoneName: long ? \"long\" : \"short\" }).substr(wotz.length);\n\t//wtz = wtz.replace(/[+-]+[0-9]+$/, \"\");\n\tif (savings === false) {\n\t\twtz = wtz.replace(/ (standard|daylight|summer|winter) /i, \" \");\n\t}\n\treturn wtz;\n}\n\n\nexport function capitalizeFirst(text: string): string {\n\treturn text.charAt(0).toUpperCase() + text.slice(1);\n}\n\n\n/**\n * ============================================================================\n * COLOR UTILS\n * ============================================================================\n */\n\n\n/**\n * Represents an interface for an object that represents an RGB color.\n */\nexport interface iRGB {\n\tr: number;\n\tg: number;\n\tb: number;\n\ta?: number;\n}\n\n/**\n * Represents an interface for an object that represents an HSL color.\n */\nexport interface iHSL {\n\th: number;\n\ts: number;\n\tl: number;\n\ta?: number;\n}\n\n/**\n * The functions below are taken and adapted from Garry Tan's blog post:\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n *\n * The further attributions go mjijackson.com, which now seems to be defunct.\n */\n\n\n/**\n * Converts an HSL color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n * Assumes h, s, and l are contained in the set [0, 1] and\n * returns r, g, and b in the set [0, 255].\n *\n * Function adapted from:\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n *\n * @ignore Exclude from docs\n * @param h       The hue\n * @param s       The saturation\n * @param l       The lightness\n * @return The RGB representation\n */\nexport function hslToRgb(color: iHSL): iRGB {\n\tlet r, g, b;\n\tlet h = color.h;\n\tlet s = color.s;\n\tlet l = color.l;\n\n\tif (s == 0) {\n\t\tr = g = b = l; // achromatic\n\t} else {\n\t\tlet hue2rgb = function hue2rgb(p: number, q: number, t: number) {\n\t\t\tif (t < 0) { t += 1; }\n\t\t\tif (t > 1) { t -= 1; }\n\t\t\tif (t < 1 / 6) { return p + (q - p) * 6 * t; }\n\t\t\tif (t < 1 / 2) { return q; }\n\t\t\tif (t < 2 / 3) { return p + (q - p) * (2 / 3 - t) * 6; }\n\t\t\treturn p;\n\t\t}\n\n\t\tlet q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n\t\tlet p = 2 * l - q;\n\t\tr = hue2rgb(p, q, h + 1 / 3);\n\t\tg = hue2rgb(p, q, h);\n\t\tb = hue2rgb(p, q, h - 1 / 3);\n\t}\n\n\treturn {\n\t\tr: Math.round(r * 255),\n\t\tg: Math.round(g * 255),\n\t\tb: Math.round(b * 255)\n\t};\n}\n\n/**\n * Converts an RGB color value to HSL. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n * Assumes r, g, and b are contained in the set [0, 255] and\n * returns h, s, and l in the set [0, 1].\n *\n * Function adapted from:\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n *\n * @ignore Exclude from docs\n * @param r       The red color value\n * @param g       The green color value\n * @param b       The blue color value\n * @return The HSL representation\n */\nexport function rgbToHsl(color: iRGB): iHSL {\n\tlet r = color.r / 255;\n\tlet g = color.g / 255;\n\tlet b = color.b / 255;\n\tlet max = Math.max(r, g, b);\n\tlet min = Math.min(r, g, b);\n\tlet h = 0;\n\tlet s = 0;\n\tlet l = (max + min) / 2;\n\n\tif (max === min) {\n\t\th = s = 0; // achromatic\n\n\t} else {\n\t\tlet d = max - min;\n\n\t\ts = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n\t\tswitch (max) {\n\t\t\tcase r: h = (g - b) / d + (g < b ? 6 : 0); break;\n\t\t\tcase g: h = (b - r) / d + 2; break;\n\t\t\tcase b: h = (r - g) / d + 4; break;\n\t\t}\n\n\t\th /= 6;\n\t}\n\n\treturn {\n\t\th: h,\n\t\ts: s,\n\t\tl: l\n\t};\n}\n\n/**\n * Returns a color that is `percent` brighter than the reference color.\n *\n * @ignore Exclude from docs\n * @param color    Reference color\n * @param percent  Brightness percent\n * @return Hex code of the new color\n */\nexport function lighten(rgb: $type.Optional<iRGB>, percent: number): $type.Optional<iRGB> {\n\tif (rgb) {\n\t\treturn {\n\t\t\tr: Math.max(0, Math.min(255, rgb.r + getLightnessStep(rgb.r, percent))),\n\t\t\tg: Math.max(0, Math.min(255, rgb.g + getLightnessStep(rgb.g, percent))),\n\t\t\tb: Math.max(0, Math.min(255, rgb.b + getLightnessStep(rgb.b, percent))),\n\t\t\ta: rgb.a\n\t\t};\n\n\t} else {\n\t\t// TODO is this correct ?\n\t\treturn rgb;\n\t}\n};\n\n/**\n * Gets lightness step.\n *\n * @ignore Exclude from docs\n * @param value    Value\n * @param percent  Percent\n * @return Step\n */\nexport function getLightnessStep(value: number, percent: number): number {\n\tlet base = percent > 0 ? 255 - value : value;\n\treturn Math.round(base * percent);\n}\n\n/**\n * Returns a color that is `percent` brighter than the source `color`.\n *\n * @ignore Exclude from docs\n * @param color    Source color\n * @param percent  Brightness percent\n * @return New color\n */\nexport function brighten(rgb: $type.Optional<iRGB>, percent: number): $type.Optional<iRGB> {\n\tif (rgb) {\n\t\tlet base = Math.min(Math.max(rgb.r, rgb.g, rgb.b), 230);\n\t\t//let base = Math.max(rgb.r, rgb.g, rgb.b);\n\t\tlet step = getLightnessStep(base, percent);\n\t\treturn {\n\t\t\tr: Math.max(0, Math.min(255, Math.round(rgb.r + step))),\n\t\t\tg: Math.max(0, Math.min(255, Math.round(rgb.g + step))),\n\t\t\tb: Math.max(0, Math.min(255, Math.round(rgb.b + step))),\n\t\t\ta: rgb.a\n\t\t};\n\n\t} else {\n\t\t// TODO is this correct ?\n\t\treturn rgb;\n\t}\n};\n\n/**\n * Returns brightness step.\n *\n * @ignore Exclude from docs\n * @param value    Value\n * @param percent  Percent\n * @return Step\n */\nexport function getBrightnessStep(_value: number, percent: number): number {\n\tlet base = 255; //percent > 0 ? 255 - value : value;\n\treturn Math.round(base * percent);\n}\n\n/**\n * Returns `true` if color is \"light\". Useful indetermining which contrasting\n * color to use for elements over this color. E.g.: you would want to use\n * black text over light background, and vice versa.\n *\n * @ignore Exclude from docs\n * @param color  Source color\n * @return Light?\n */\nexport function isLight(color: iRGB): boolean {\n\treturn ((color.r * 299) + (color.g * 587) + (color.b * 114)) / 1000 >= 128;\n}\n\n/**\n * Returns a new [[iRGB]] object based on `rgb` parameter with specific\n * saturation applied.\n *\n * `saturation` can be in the range of 0 (fully desaturated) to 1 (fully\n * saturated).\n *\n * @ignore Exclude from docs\n * @param color       Base color\n * @param saturation  Saturation (0-1)\n * @return New color\n */\nexport function saturate(rgb: $type.Optional<iRGB>, saturation: number): $type.Optional<iRGB> {\n\tif (rgb === undefined || saturation == 1) {\n\t\treturn rgb;\n\t}\n\n\tlet hsl = rgbToHsl(rgb);\n\thsl.s = saturation;\n\treturn hslToRgb(hsl);\n}\n\nexport function alternativeColor(color: iRGB, lightAlternative: iRGB = { r: 255, g: 255, b: 255 }, darkAlternative: iRGB = { r: 255, g: 255, b: 255 }): iRGB {\n\tlet light = lightAlternative;\n\tlet dark = darkAlternative;\n\tif (isLight(darkAlternative)) {\n\t\tlight = darkAlternative;\n\t\tdark = lightAlternative;\n\t}\n\treturn isLight(color) ? dark : light;\n}\n\n/**\n * @ignore\n * @deprecated\n */\n// export function unshiftThemeClass(settings: any, themeClass: string) {\n// \tlet themeClasses = settings.themeClasses;\n// \tif (!themeClasses) {\n// \t\tthemeClasses = [];\n// \t}\n// \tthemeClasses.unshift(themeClass);\n// \tsettings.themeClasses = themeClasses;\n// }\n\n/**\n * @ignore\n * @deprecated\n */\n// export function pushThemeClass(settings: any, themeClass: string) {\n// \tlet themeClasses = settings.themeClasses;\n// \tif (!themeClasses) {\n// \t\tthemeClasses = [];\n// \t}\n// \tthemeClasses.push(themeClass);\n// \tsettings.themeClasses = themeClasses;\n// }\n\n/**\n * @ignore\n */\nexport function mergeTags(tags1: string[] | undefined, tags2: string[]): string[] {\n\tif (!tags1) {\n\t\ttags1 = [];\n\t}\n\treturn [...tags1, ...tags2].filter((value, index, self) => {\n\t\treturn self.indexOf(value) === index;\n\t});\n}\n\n/**\n * @ignore\n */\nexport function sameBounds(a: IBounds, b?: IBounds): boolean {\n\tif (!b) {\n\t\treturn false;\n\t}\n\tif (a.left != b.left) {\n\t\treturn false\n\t}\n\tif (a.right != b.right) {\n\t\treturn false\n\t}\n\tif (a.top != b.top) {\n\t\treturn false\n\t}\n\tif (a.bottom != b.bottom) {\n\t\treturn false\n\t}\n\treturn true;\n}"],"sourceRoot":""},"metadata":{},"sourceType":"module"}