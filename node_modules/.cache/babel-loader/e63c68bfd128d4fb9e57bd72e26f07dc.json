{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useEffect,useRef}from'react';import axios from'axios';import{useSelector,useDispatch}from'react-redux';import{useHistory}from'react-router-dom';import{Box,Button}from'@mui/material';import{initUser,setEmailError,setPasswordError,setDisabledSaveButton,setAdminUsersError}from'../../../../redux/slices/adminUsers';import Header from'./Header';import Email from'./Email';import Password from'./Password';import Role from'./Role';import Status from'./Status';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var userFormContainerStyle={boxSizing:'border-box',display:'flex',flexDirection:'column',flexWrap:'wrap',gap:4,paddingLeft:4,paddingRight:4,paddingTop:2,maxWidth:616,minWidth:288};var container3Style={display:'flex',gap:3,flexGrow:1};var buttonsContainerStyle={display:'flex',paddingBottom:'32px',paddingTop:'8px',marginLeft:'-10px'};var buttonStyle={margin:'0 10px'};var EMAIL_REGEX=/^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/;// eslint-disable-next-line\nvar PASSWORD_REGEX=/^[a-zA-Z0-9!@#$%^&*()_+~`\\-=\\\\\\/|[\\]{};:'\",<.>?]*$/;var UserForm=function UserForm(_ref){var newUser=_ref.newUser;var dispatch=useDispatch();var history=useHistory();var token=useSelector(function(state){return state.auth.token;});var email=useSelector(function(state){return state.adminUsers.email;});var password=useSelector(function(state){return state.adminUsers.password;});var role=useSelector(function(state){return state.adminUsers.role;});var status=useSelector(function(state){return state.adminUsers.status;});var disabledSaveButton=useSelector(function(state){return state.adminUsers.disabledSaveButton;});var emailRef=useRef();useEffect(function(){if(emailRef){var _emailRef$current;(_emailRef$current=emailRef.current)===null||_emailRef$current===void 0?void 0:_emailRef$current.children[0].focus();}dispatch(setEmailError(''));dispatch(setPasswordError(''));// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(function(){if(email.trim()&&password.trim()){dispatch(setDisabledSaveButton(false));}else{dispatch(setDisabledSaveButton(true));}},[dispatch,email,password]);var goBack=function goBack(){history.goBack();dispatch(initUser());};var saveUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var user,response,_response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(EMAIL_REGEX.test(email)){_context.next=3;break;}dispatch(setEmailError('Please provide correct e-mail address'));return _context.abrupt(\"return\");case 3:if(!(email.length<5||email.length>35)){_context.next=6;break;}dispatch(setEmailError('Email address must be at least 5 characters long, maximum 35 characters long'));return _context.abrupt(\"return\");case 6:if(PASSWORD_REGEX.test(password)){_context.next=9;break;}dispatch(setPasswordError('Password can only contain english letters, numbers and special characters, and must be at least 5 characters long, maximum 10 characters long'));return _context.abrupt(\"return\");case 9:if(!(password.length<5||password.length>10)){_context.next=12;break;}dispatch(setPasswordError('Password must be at least 5 characters long, maximum 10 characters long'));return _context.abrupt(\"return\");case 12:user={email:email.toLowerCase(),password:password,role:role,status:status};if(!newUser){_context.next=24;break;}_context.prev=14;_context.next=17;return axios({method:'post',url:'/api/admin/users',headers:{Authorization:token},data:user});case 17:response=_context.sent;if(response.status>=200&&response.status<300){goBack();}_context.next=24;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](14);if(axios.isAxiosError(_context.t0)){if(_context.t0&&_context.t0.response){dispatch(setAdminUsersError(_context.t0.response.data.message));}}case 24:if(newUser){_context.next=35;break;}_context.prev=25;_context.next=28;return axios({method:'put',url:'/api/admin/users',headers:{Authorization:token},data:user});case 28:_response=_context.sent;if(_response.status>=200&&_response.status<300){goBack();}_context.next=35;break;case 32:_context.prev=32;_context.t1=_context[\"catch\"](25);if(axios.isAxiosError(_context.t1)){if(_context.t1&&_context.t1.response){dispatch(setAdminUsersError(_context.t1.response.data.message));}}case 35:case\"end\":return _context.stop();}}},_callee,null,[[14,21],[25,32]]);}));return function saveUser(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Box,{sx:userFormContainerStyle,children:[/*#__PURE__*/_jsx(Header,{newUser:newUser}),/*#__PURE__*/_jsx(Email,{ref:emailRef,newUser:newUser}),/*#__PURE__*/_jsx(Password,{newUser:newUser}),/*#__PURE__*/_jsxs(Box,{sx:container3Style,children:[/*#__PURE__*/_jsx(Role,{}),/*#__PURE__*/_jsx(Status,{})]}),/*#__PURE__*/_jsxs(Box,{sx:buttonsContainerStyle,children:[/*#__PURE__*/_jsx(Button,{sx:buttonStyle,variant:\"outlined\",onClick:goBack,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{sx:buttonStyle,variant:\"outlined\",onClick:saveUser,disabled:disabledSaveButton,children:\"Save\"})]})]});};export default UserForm;","map":{"version":3,"sources":["/Users/dcurchin/Desktop/final/grocery-shop-ui/src/components/adminPanel/users/editAndAddNewUser/UserForm.jsx"],"names":["useEffect","useRef","axios","useSelector","useDispatch","useHistory","Box","Button","initUser","setEmailError","setPasswordError","setDisabledSaveButton","setAdminUsersError","Header","Email","Password","Role","Status","userFormContainerStyle","boxSizing","display","flexDirection","flexWrap","gap","paddingLeft","paddingRight","paddingTop","maxWidth","minWidth","container3Style","flexGrow","buttonsContainerStyle","paddingBottom","marginLeft","buttonStyle","margin","EMAIL_REGEX","PASSWORD_REGEX","UserForm","newUser","dispatch","history","token","state","auth","email","adminUsers","password","role","status","disabledSaveButton","emailRef","current","children","focus","trim","goBack","saveUser","e","test","length","user","toLowerCase","method","url","headers","Authorization","data","response","isAxiosError","message"],"mappings":"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","sourcesContent":["import { useEffect, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { Box, Button } from '@mui/material';\r\nimport {\r\n  initUser,\r\n  setEmailError,\r\n  setPasswordError,\r\n  setDisabledSaveButton,\r\n  setAdminUsersError,\r\n} from '../../../../redux/slices/adminUsers';\r\nimport Header from './Header';\r\nimport Email from './Email';\r\nimport Password from './Password';\r\nimport Role from './Role';\r\nimport Status from './Status';\r\n\r\nconst userFormContainerStyle = {\r\n  boxSizing: 'border-box',\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  flexWrap: 'wrap',\r\n  gap: 4,\r\n  paddingLeft: 4,\r\n  paddingRight: 4,\r\n  paddingTop: 2,\r\n  maxWidth: 616,\r\n  minWidth: 288,\r\n};\r\n\r\nconst container3Style = { display: 'flex', gap: 3, flexGrow: 1 };\r\n\r\nconst buttonsContainerStyle = {\r\n  display: 'flex',\r\n  paddingBottom: '32px',\r\n  paddingTop: '8px',\r\n  marginLeft: '-10px',\r\n};\r\n\r\nconst buttonStyle = {\r\n  margin: '0 10px',\r\n};\r\n\r\nconst EMAIL_REGEX = /^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/;\r\n\r\n// eslint-disable-next-line\r\nconst PASSWORD_REGEX = /^[a-zA-Z0-9!@#$%^&*()_+~`\\-=\\\\\\/|[\\]{};:'\",<.>?]*$/;\r\n\r\nconst UserForm = ({ newUser }) => {\r\n  const dispatch = useDispatch();\r\n\r\n  const history = useHistory();\r\n\r\n  const token = useSelector((state) => state.auth.token);\r\n  const email = useSelector((state) => state.adminUsers.email);\r\n  const password = useSelector((state) => state.adminUsers.password);\r\n  const role = useSelector((state) => state.adminUsers.role);\r\n  const status = useSelector((state) => state.adminUsers.status);\r\n\r\n  const disabledSaveButton = useSelector(\r\n    (state) => state.adminUsers.disabledSaveButton\r\n  );\r\n\r\n  const emailRef = useRef();\r\n\r\n  useEffect(() => {\r\n    if (emailRef) {\r\n      emailRef.current?.children[0].focus();\r\n    }\r\n\r\n    dispatch(setEmailError(''));\r\n    dispatch(setPasswordError(''));\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (email.trim() && password.trim()) {\r\n      dispatch(setDisabledSaveButton(false));\r\n    } else {\r\n      dispatch(setDisabledSaveButton(true));\r\n    }\r\n  }, [dispatch, email, password]);\r\n\r\n  const goBack = () => {\r\n    history.goBack();\r\n    dispatch(initUser());\r\n  };\r\n\r\n  const saveUser = async (e) => {\r\n    if (!EMAIL_REGEX.test(email)) {\r\n      dispatch(setEmailError('Please provide correct e-mail address'));\r\n      return;\r\n    }\r\n\r\n    if (email.length < 5 || email.length > 35) {\r\n      dispatch(\r\n        setEmailError(\r\n          'Email address must be at least 5 characters long, maximum 35 characters long'\r\n        )\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (!PASSWORD_REGEX.test(password)) {\r\n      dispatch(\r\n        setPasswordError(\r\n          'Password can only contain english letters, numbers and special characters, and must be at least 5 characters long, maximum 10 characters long'\r\n        )\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (password.length < 5 || password.length > 10) {\r\n      dispatch(\r\n        setPasswordError(\r\n          'Password must be at least 5 characters long, maximum 10 characters long'\r\n        )\r\n      );\r\n      return;\r\n    }\r\n\r\n    const user = {\r\n      email: email.toLowerCase(),\r\n      password,\r\n      role,\r\n      status,\r\n    };\r\n\r\n    if (newUser) {\r\n      try {\r\n        const response = await axios({\r\n          method: 'post',\r\n          url: '/api/admin/users',\r\n          headers: {\r\n            Authorization: token,\r\n          },\r\n          data: user,\r\n        });\r\n        if (response.status >= 200 && response.status < 300) {\r\n          goBack();\r\n        }\r\n      } catch (err) {\r\n        if (axios.isAxiosError(err)) {\r\n          if (err && err.response) {\r\n            dispatch(setAdminUsersError(err.response.data.message));\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!newUser) {\r\n      try {\r\n        const response = await axios({\r\n          method: 'put',\r\n          url: '/api/admin/users',\r\n          headers: {\r\n            Authorization: token,\r\n          },\r\n          data: user,\r\n        });\r\n        if (response.status >= 200 && response.status < 300) {\r\n          goBack();\r\n        }\r\n      } catch (err) {\r\n        if (axios.isAxiosError(err)) {\r\n          if (err && err.response) {\r\n            dispatch(setAdminUsersError(err.response.data.message));\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box sx={userFormContainerStyle}>\r\n      <Header newUser={newUser} />\r\n      <Email ref={emailRef} newUser={newUser} />\r\n      <Password newUser={newUser} />\r\n      <Box sx={container3Style}>\r\n        <Role />\r\n        <Status />\r\n      </Box>\r\n      <Box sx={buttonsContainerStyle}>\r\n        <Button sx={buttonStyle} variant=\"outlined\" onClick={goBack}>\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          sx={buttonStyle}\r\n          variant=\"outlined\"\r\n          onClick={saveUser}\r\n          disabled={disabledSaveButton}\r\n        >\r\n          Save\r\n        </Button>\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default UserForm;\r\n"]},"metadata":{},"sourceType":"module"}