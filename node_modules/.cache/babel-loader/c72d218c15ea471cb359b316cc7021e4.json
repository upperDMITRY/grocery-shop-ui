{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/dcurchin/Desktop/final/grocery-shop-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from'react';import{Link,useHistory}from'react-router-dom';import{useSelector,useDispatch}from'react-redux';import axios from'axios';import{Box,Paper,Typography}from'@mui/material';import RegistrationInput from'../../components/login/LoginInput';import CommonButton from'../../components/common/buttons/CommonButton';import GreenPageHeader from'./../../components/common/GreenPageHeader';import ButtonSpinner from'../../components/common/ButtonSpinner';import AuthErrorAlert from'../../components/common/AuthErrorAlert';import{emailValidation}from'../../helpers/emailValidation';import{passwordValidation}from'../../helpers/passwordValidation';import{setIsAuth,setError}from'../../redux/slices/authSlice';import{setLoading}from'../../redux/slices/registrationSlice';import{pageContainerStyle,formContainerStyle,formStyle,footerLinksStyle}from'../../components/common/styles/loginAndRegistrationStyles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RegistrationContainer=function RegistrationContainer(){var history=useHistory();var dispatch=useDispatch();var loading=useSelector(function(state){return state.registration.loading;});var cartItems=useSelector(function(state){return state.cart.cartItems;});var visitorId=useSelector(function(state){return state.auth.visitorId;});var _useState=useState({email:'',password:'',errorEmail:'',errorPassword:''}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var handleChange=function handleChange(e){var _objectSpread2;setState(_objectSpread(_objectSpread({},state),{},(_objectSpread2={},_defineProperty(_objectSpread2,e.target.name,e.target.value),_defineProperty(_objectSpread2,\"errorEmail\",e.target.name==='email'?'':state.errorEmail),_defineProperty(_objectSpread2,\"errorPassword\",e.target.name==='password'?'':state.errorPassword),_objectSpread2)));};var email=state.email,password=state.password;var handleClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(emailValidation(state,setState)&&passwordValidation(state,setState))){_context.next=16;break;}_context.prev=2;dispatch(setLoading(true));_context.next=6;return axios.post('/api/registration',{email:email.toLowerCase(),password:password,cartItems:cartItems,visitorId:visitorId});case 6:response=_context.sent;if(response.status===200){localStorage.setItem('visitorId',visitorId);dispatch(setIsAuth({email:response.data.email,token:response.data.token,isAuth:true}));history.push('/');}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);if(axios.isAxiosError(_context.t0)){if(_context.t0&&_context.t0.response){dispatch(setError(_context.t0.response.data.message));}}case 13:_context.prev=13;dispatch(setLoading(false));return _context.finish(13);case 16:case\"end\":return _context.stop();}}},_callee,null,[[2,10,13,16]]);}));return function handleClick(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AuthErrorAlert,{}),/*#__PURE__*/_jsx(GreenPageHeader,{title:\"Create Account\"}),/*#__PURE__*/_jsx(Box,{sx:pageContainerStyle,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:formContainerStyle,children:[/*#__PURE__*/_jsxs(Box,{component:\"form\",sx:formStyle,noValidate:true,autoComplete:\"off\",children:[/*#__PURE__*/_jsx(RegistrationInput,{label:\"Email\",type:\"email\",autoFocus:true,value:state.email,error:state.errorEmail,handleChange:handleChange}),/*#__PURE__*/_jsx(RegistrationInput,{label:\"Password\",type:\"password\",value:state.password,error:state.errorPassword,handleChange:handleChange}),/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsxs(CommonButton,{padding:\"7px 30px\",fontSize:\"16px\",onClick:handleClick,type:\"submit\",disabled:loading,children:['Create',loading&&/*#__PURE__*/_jsx(ButtonSpinner,{})]})})]}),/*#__PURE__*/_jsx(Box,{sx:footerLinksStyle,children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(Typography,{children:\"Return to Store\"})})})]})})]});};export default RegistrationContainer;","map":{"version":3,"sources":["/Users/dcurchin/Desktop/final/grocery-shop-ui/src/pages/registration/RegistrationContainer.jsx"],"names":["useState","Link","useHistory","useSelector","useDispatch","axios","Box","Paper","Typography","RegistrationInput","CommonButton","GreenPageHeader","ButtonSpinner","AuthErrorAlert","emailValidation","passwordValidation","setIsAuth","setError","setLoading","pageContainerStyle","formContainerStyle","formStyle","footerLinksStyle","RegistrationContainer","history","dispatch","loading","state","registration","cartItems","cart","visitorId","auth","email","password","errorEmail","errorPassword","setState","handleChange","e","target","name","value","handleClick","preventDefault","post","toLowerCase","response","status","localStorage","setItem","data","token","isAuth","push","isAxiosError","message"],"mappings":"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","sourcesContent":["import { useState } from 'react';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport axios from 'axios';\r\nimport { Box, Paper, Typography } from '@mui/material';\r\nimport RegistrationInput from '../../components/login/LoginInput';\r\nimport CommonButton from '../../components/common/buttons/CommonButton';\r\nimport GreenPageHeader from './../../components/common/GreenPageHeader';\r\nimport ButtonSpinner from '../../components/common/ButtonSpinner';\r\nimport AuthErrorAlert from '../../components/common/AuthErrorAlert';\r\nimport { emailValidation } from '../../helpers/emailValidation';\r\nimport { passwordValidation } from '../../helpers/passwordValidation';\r\nimport { setIsAuth, setError } from '../../redux/slices/authSlice';\r\nimport { setLoading } from '../../redux/slices/registrationSlice';\r\nimport {\r\n  pageContainerStyle,\r\n  formContainerStyle,\r\n  formStyle,\r\n  footerLinksStyle,\r\n} from '../../components/common/styles/loginAndRegistrationStyles';\r\n\r\nconst RegistrationContainer = () => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const loading = useSelector((state) => state.registration.loading);\r\n  const cartItems = useSelector((state) => state.cart.cartItems);\r\n  const visitorId = useSelector((state) => state.auth.visitorId);\r\n\r\n  const [state, setState] = useState({\r\n    email: '',\r\n    password: '',\r\n    errorEmail: '',\r\n    errorPassword: '',\r\n  });\r\n\r\n  const handleChange = (e) => {\r\n    setState({\r\n      ...state,\r\n      [e.target.name]: e.target.value,\r\n      errorEmail: e.target.name === 'email' ? '' : state.errorEmail,\r\n      errorPassword: e.target.name === 'password' ? '' : state.errorPassword,\r\n    });\r\n  };\r\n\r\n  const { email, password } = state;\r\n\r\n  const handleClick = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (\r\n      emailValidation(state, setState) &&\r\n      passwordValidation(state, setState)\r\n    ) {\r\n      try {\r\n        dispatch(setLoading(true));\r\n\r\n        const response = await axios.post('/api/registration', {\r\n          email: email.toLowerCase(),\r\n          password,\r\n          cartItems,\r\n          visitorId,\r\n        });\r\n\r\n        if (response.status === 200) {\r\n          localStorage.setItem('visitorId', visitorId);\r\n          dispatch(\r\n            setIsAuth({\r\n              email: response.data.email,\r\n              token: response.data.token,\r\n              isAuth: true,\r\n            })\r\n          );\r\n\r\n          history.push('/');\r\n        }\r\n      } catch (err) {\r\n        if (axios.isAxiosError(err)) {\r\n          if (err && err.response) {\r\n            dispatch(setError(err.response.data.message));\r\n          }\r\n        }\r\n      } finally {\r\n        dispatch(setLoading(false));\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <AuthErrorAlert />\r\n      <GreenPageHeader title=\"Create Account\" />\r\n      <Box sx={pageContainerStyle}>\r\n        <Paper elevation={0} sx={formContainerStyle}>\r\n          <Box component=\"form\" sx={formStyle} noValidate autoComplete=\"off\">\r\n            <RegistrationInput\r\n              label=\"Email\"\r\n              type=\"email\"\r\n              autoFocus={true}\r\n              value={state.email}\r\n              error={state.errorEmail}\r\n              handleChange={handleChange}\r\n            />\r\n            <RegistrationInput\r\n              label=\"Password\"\r\n              type=\"password\"\r\n              value={state.password}\r\n              error={state.errorPassword}\r\n              handleChange={handleChange}\r\n            />\r\n            <Box>\r\n              <CommonButton\r\n                padding=\"7px 30px\"\r\n                fontSize=\"16px\"\r\n                onClick={handleClick}\r\n                type=\"submit\"\r\n                disabled={loading}\r\n              >\r\n                {'Create'}\r\n                {loading && <ButtonSpinner />}\r\n              </CommonButton>\r\n            </Box>\r\n          </Box>\r\n          <Box sx={footerLinksStyle}>\r\n            <Link to=\"/\">\r\n              <Typography>Return to Store</Typography>\r\n            </Link>\r\n          </Box>\r\n        </Paper>\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RegistrationContainer;\r\n"]},"metadata":{},"sourceType":"module"}